define("app/ui/inline_edit",["module","require","exports","core/component"],function(module, require, exports) {
function inlineEdit(){var a=1.2;this.defaultAttrs({editableFieldSelector:".editable-field",profileFieldSelector:".profile-field",globalProfileFieldSelector:null,globalProfileFieldContainerSelector:null,measuringFieldSelector:".measuring-field",padding:20,extraCharsForMeasuring:""}),this.syncDimensions=function(){if(!this.$measuringField.length)return;var a=this.getDimensions(this.currentText());if(this.isTextArea){var b=Math.ceil(a.height/this.lineHeight);this.$editableField.attr("rows",b)}else this.$editableField.width(a.width+this.padding)},this.saveOldValues=function(){this.oldTextValue=this.editableFieldValue(),this.oldHtmlValue=this.$profileField.html()},this.resetProfileField=function(){this.$profileField.html(this.oldHtmlValue)},this.resetToOldValues=function(){this.$editableField.val(this.oldTextValue).trigger("uiInputChanged"),this.resetProfileField(),this.updateProfileFieldContainerVisibility()},this.syncValue=function(){var a=this.editableFieldValue();this.oldTextValue!==a&&(this.setProfileField(),this.trigger("uiInlineEditSave",{newValue:a,field:this.$editableField.attr("name")}))},this.setProfileField=function(){var a=this.editableFieldValue();this.truncateLength&&a.length>this.truncateLength&&(a=a.substr(0,this.truncateLength)+"â€¦"),this.$profileField.text(a),this.updateProfileFieldContainerVisibility()},this.currentText=function(){return this.editableFieldValue()||this.getPlaceholderText()},this.editableFieldValue=function(){return this.$editableField.val()},this.updateProfileFieldContainerVisibility=function(){var a=this.editableFieldValue().trim()=="";this.$profileFieldContainer.toggleClass("u-hidden",a)},this.addPadding=function(){this.padding=this.attr.padding},this.removePadding=function(){this.padding=0},this.getDimensions=function(a){return this.truncateLength&&(a=a.substr(0,this.truncateLength)),this.prevText!==a&&(this.measureDimensions(a),this.prevText=a),{width:this.width,height:this.height}},this.measureDimensions=function(a){this.$measuringField.text(a+this.attr.extraCharsForMeasuring),this.height=this.$measuringField.height(),this.width=this.$measuringField.width()},this.preventNewlineAndLeadingSpace=function(a){if(a.keyCode===13||a.keyCode===32&&!this.editableFieldValue())a.preventDefault(),a.stopImmediatePropagation()},this.getPlaceholderText=function(){return this.$editableField.attr("placeholder")},this.closeOpenDropdowns=function(){this.trigger("uiEditProfileHideOptions")},this.after("initialize",function(){this.$editableField=this.select("editableFieldSelector"),this.$profileField=this.attr.globalProfileFieldSelector?$(this.attr.globalProfileFieldSelector):this.select("profileFieldSelector"),this.$measuringField=this.select("measuringFieldSelector"),this.$profileFieldContainer=$(this.attr.globalProfileFieldContainerSelector),this.lineHeight=parseInt(this.$profileField.css("line-height"),10)||parseInt(this.$profileField.css("font-size"),10)*a,this.isTextArea=this.$editableField.is("textarea"),this.truncateLength=parseInt(this.$editableField.attr("data-truncate-length"),10),this.padding=0,this.on(document,"uiNeedsTextPreview",this.setProfileField),this.on(document,"uiEditProfileSaveFields",this.syncValue),this.on(document,"uiEditProfileStart",this.saveOldValues),this.on(document,"uiEditProfileCancel",this.resetToOldValues),this.on(document,"uiEditProfileStart",this.syncDimensions),this.on(document,"uiShowProfileEditError",this.resetProfileField),this.on(this.$editableField,"keydown",this.preventNewlineAndLeadingSpace),this.on(this.$editableField,"focus",this.closeOpenDropdowns),this.isTextArea||(this.on(this.$editableField,"focus",this.addPadding),this.on(this.$editableField,"blur",this.removePadding)),this.on(this.$editableField,"keyup focus blur update paste",this.syncDimensions)})}var defineComponent=require("core/component");module.exports=defineComponent(inlineEdit)
});
define("app/data/async_profile",["module","require","exports","core/component","app/data/with_data"],function(module, require, exports) {
function asyncProfileData(){this.defaultAttrs({noShowError:!0}),this.saveField=function(a,b){this.fields[b.field]=b.newValue},this.clearFields=function(){this.fields={}},this.saveFields=function(a,b){function c(a){if(a.error===!0)return d.call(this,a);this.trigger("dataInlineEditSaveSuccess",a),this.clearFields()}function d(a){this.trigger("dataInlineEditSaveError",a),this.clearFields()}a.preventDefault(),Object.keys(this.fields).length>0?(this.trigger("dataInlineEditSaveStarted",{}),this.fields.page_context=this.attr.pageName,this.fields.section_context=this.attr.sectionName,this.post({url:"/i/profiles/update",data:this.fields,eventData:b,success:c.bind(this),error:d.bind(this)})):this.trigger("dataInlineEditSaveSuccess")},this.after("initialize",function(){this.fields={},this.on("uiInlineEditSave",this.saveField),this.on("uiEditProfileSave",this.saveFields)})}var defineComponent=require("core/component"),withData=require("app/data/with_data");module.exports=defineComponent(asyncProfileData,withData)
});
deferred('$lib/jquery_ui.profile.js', function() {
/*! jQuery UI 1.8.22 (c) 2012 http://jqueryui.com/about http://jquery.org/license */(function($,a){function b(a,b){var d=a.nodeName.toLowerCase();if("area"===d){var e=a.parentNode,f=e.name,g;return!a.href||!f||e.nodeName.toLowerCase()!=="map"?!1:(g=$("img[usemap=#"+f+"]")[0],!!g&&c(g))}return(/input|select|textarea|button|object/.test(d)?!a.disabled:"a"==d?a.href||b:b)&&c(a)}function c(a){return!$(a).parents().andSelf().filter(function(){return $.curCSS(this,"visibility")==="hidden"||$.expr.filters.hidden(this)}).length}$.ui=$.ui||{};if($.ui.version)return;$.extend($.ui,{version:"1.8.22",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),$.fn.extend({propAttr:$.fn.prop||$.fn.attr,_focus:$.fn.focus,focus:function(a,b){return typeof a=="number"?this.each(function(){var c=this;setTimeout(function(){$(c).focus(),b&&b.call(c)},a)}):this._focus.apply(this,arguments)},scrollParent:function(){var a;return $.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?a=this.parents().filter(function(){return/(relative|absolute|fixed)/.test($.curCSS(this,"position",1))&&/(auto|scroll)/.test($.curCSS(this,"overflow",1)+$.curCSS(this,"overflow-y",1)+$.curCSS(this,"overflow-x",1))}).eq(0):a=this.parents().filter(function(){return/(auto|scroll)/.test($.curCSS(this,"overflow",1)+$.curCSS(this,"overflow-y",1)+$.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!a.length?$(document):a},zIndex:function(b){if(b!==a)return this.css("zIndex",b);if(this.length){var c=$(this[0]),d,e;while(c.length&&c[0]!==document){d=c.css("position");if(d==="absolute"||d==="relative"||d==="fixed"){e=parseInt(c.css("zIndex"),10);if(!isNaN(e)&&e!==0)return e}c=c.parent()}}return 0},disableSelection:function(){return this.bind(($.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),$("<a>").outerWidth(1).jquery||$.each(["Width","Height"],function(b,c){function g(a,b,c,e){return $.each(d,function(){b-=parseFloat($.curCSS(a,"padding"+this,!0))||0,c&&(b-=parseFloat($.curCSS(a,"border"+this+"Width",!0))||0),e&&(b-=parseFloat($.curCSS(a,"margin"+this,!0))||0)}),b}var d=c==="Width"?["Left","Right"]:["Top","Bottom"],e=c.toLowerCase(),f={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};$.fn["inner"+c]=function(b){return b===a?f["inner"+c].call(this):this.each(function(){$(this).css(e,g(this,b)+"px")})},$.fn["outer"+c]=function(a,b){return typeof a!="number"?f["outer"+c].call(this,a):this.each(function(){$(this).css(e,g(this,a,!0,b)+"px")})}}),$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(a){return function(b){return!!$.data(b,a)}}):function(a,b,c){return!!$.data(a,c[3])},focusable:function(a){return b(a,!isNaN($.attr(a,"tabindex")))},tabbable:function(a){var c=$.attr(a,"tabindex"),d=isNaN(c);return(d||c>=0)&&b(a,!d)}}),$(function(){var a=document.body,b=a.appendChild(b=document.createElement("div"));b.offsetHeight,$.extend(b.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),$.support.minHeight=b.offsetHeight===100,$.support.selectstart="onselectstart"in b,a.removeChild(b).style.display="none"}),$.curCSS||($.curCSS=$.css),$.extend($.ui,{plugin:{add:function(a,b,c){var d=$.ui[a].prototype;for(var e in c)d.plugins[e]=d.plugins[e]||[],d.plugins[e].push([b,c[e]])},call:function(a,b,c){var d=a.plugins[b];if(!d||!a.element[0].parentNode)return;for(var e=0;e<d.length;e++)a.options[d[e][0]]&&d[e][1].apply(a.element,c)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(a,b){if($(a).css("overflow")==="hidden")return!1;var c=b&&b==="left"?"scrollLeft":"scrollTop",d=!1;return a[c]>0?!0:(a[c]=1,d=a[c]>0,a[c]=0,d)},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(a,b,c,d,e,f){return $.ui.isOverAxis(a,c,e)&&$.ui.isOverAxis(b,d,f)}})})(jQuery),function($,a){if($.cleanData){var b=$.cleanData;$.cleanData=function(a){for(var c=0,d;(d=a[c])!=null;c++)try{$(d).triggerHandler("remove")}catch(e){}b(a)}}else{var c=$.fn.remove;$.fn.remove=function(a,b){return this.each(function(){return b||(!a||$.filter(a,[this]).length)&&$("*",this).add([this]).each(function(){try{$(this).triggerHandler("remove")}catch(a){}}),c.call($(this),a,b)})}}$.widget=function(a,b,c){var d=a.split(".")[0],e;a=a.split(".")[1],e=d+"-"+a,c||(c=b,b=$.Widget),$.expr[":"][e]=function(b){return!!$.data(b,a)},$[d]=$[d]||{},$[d][a]=function(a,b){arguments.length&&this._createWidget(a,b)};var f=new b;f.options=$.extend(!0,{},f.options),$[d][a].prototype=$.extend(!0,f,{namespace:d,widgetName:a,widgetEventPrefix:$[d][a].prototype.widgetEventPrefix||a,widgetBaseClass:e},c),$.widget.bridge(a,$[d][a])},$.widget.bridge=function(b,c){$.fn[b]=function(d){var e=typeof d=="string",f=Array.prototype.slice.call(arguments,1),g=this;return d=!e&&f.length?$.extend.apply(null,[!0,d].concat(f)):d,e&&d.charAt(0)==="_"?g:(e?this.each(function(){var c=$.data(this,b),e=c&&$.isFunction(c[d])?c[d].apply(c,f):c;if(e!==c&&e!==a)return g=e,!1}):this.each(function(){var a=$.data(this,b);a?a.option(d||{})._init():$.data(this,b,new c(d,this))}),g)}},$.Widget=function(a,b){arguments.length&&this._createWidget(a,b)},$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(a,b){$.data(b,this.widgetName,this),this.element=$(b),this.options=$.extend(!0,{},this.options,this._getCreateOptions(),a);var c=this;this.element.bind("remove."+this.widgetName,function(){c.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return $.metadata&&$.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled")},widget:function(){return this.element},option:function(b,c){var d=b;if(arguments.length===0)return $.extend({},this.options);if(typeof b=="string"){if(c===a)return this.options[b];d={},d[b]=c}return this._setOptions(d),this},_setOptions:function(a){var b=this;return $.each(a,function(a,c){b._setOption(a,c)}),this},_setOption:function(a,b){return this.options[a]=b,a==="disabled"&&this.widget()[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+"ui-state-disabled").attr("aria-disabled",b),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(a,b,c){var d,e,f=this.options[a];c=c||{},b=$.Event(b),b.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase(),b.target=this.element[0],e=b.originalEvent;if(e)for(d in e)d in b||(b[d]=e[d]);return this.element.trigger(b,c),!($.isFunction(f)&&f.call(this.element[0],b,c)===!1||b.isDefaultPrevented())}}}(jQuery),function($,a){var b=!1;$(document).mouseup(function(a){b=!1}),$.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var a=this;this.element.bind("mousedown."+this.widgetName,function(b){return a._mouseDown(b)}).bind("click."+this.widgetName,function(b){if(!0===$.data(b.target,a.widgetName+".preventClickEvent"))return $.removeData(b.target,a.widgetName+".preventClickEvent"),b.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(a){if(b)return;this._mouseStarted&&this._mouseUp(a),this._mouseDownEvent=a;var c=this,d=a.which==1,e=typeof this.options.cancel=="string"&&a.target.nodeName?$(a.target).closest(this.options.cancel).length:!1;if(!d||e||!this._mouseCapture(a))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)){this._mouseStarted=this._mouseStart(a)!==!1;if(!this._mouseStarted)return a.preventDefault(),!0}return!0===$.data(a.target,this.widgetName+".preventClickEvent")&&$.removeData(a.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return c._mouseMove(a)},this._mouseUpDelegate=function(a){return c._mouseUp(a)},$(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),a.preventDefault(),b=!0,!0},_mouseMove:function(a){return!$.browser.msie||document.documentMode>=9||!!a.button?this._mouseStarted?(this._mouseDrag(a),a.preventDefault()):(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,a)!==!1,this._mouseStarted?this._mouseDrag(a):this._mouseUp(a)),!this._mouseStarted):this._mouseUp(a)},_mouseUp:function(a){return $(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,a.target==this._mouseDownEvent.target&&$.data(a.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(a)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(a){return this.mouseDelayMet},_mouseStart:function(a){},_mouseDrag:function(a){},_mouseStop:function(a){},_mouseCapture:function(a){return!0}})}(jQuery),function($,a){$.widget("ui.draggable",$.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},destroy:function(){if(!this.element.data("draggable"))return;return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(a){var b=this.options;return this.helper||b.disabled||$(a.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(a),this.handle?(b.iframeFix&&$(b.iframeFix===!0?"iframe":b.iframeFix).each(function(){$('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css($(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(a){var b=this.options;return this.helper=this._createHelper(a),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),$.ui.ddmanager&&($.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},$.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(a),this.originalPageX=a.pageX,this.originalPageY=a.pageY,b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt),b.containment&&this._setContainment(),this._trigger("start",a)===!1?(this._clear(),!1):(this._cacheHelperProportions(),$.ui.ddmanager&&!b.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,a),this._mouseDrag(a,!0),$.ui.ddmanager&&$.ui.ddmanager.dragStart(this,a),!0)},_mouseDrag:function(a,b){this.position=this._generatePosition(a),this.positionAbs=this._convertPositionTo("absolute");if(!b){var c=this._uiHash();if(this._trigger("drag",a,c)===!1)return this._mouseUp({}),!1;this.position=c.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";return $.ui.ddmanager&&$.ui.ddmanager.drag(this,a),!1},_mouseStop:function(a){var b=!1;$.ui.ddmanager&&!this.options.dropBehaviour&&(b=$.ui.ddmanager.drop(this,a)),this.dropped&&(b=this.dropped,this.dropped=!1);var c=this.element[0],d=!1;while(c&&(c=c.parentNode))c==document&&(d=!0);if(!d&&this.options.helper==="original")return!1;if(this.options.revert=="invalid"&&!b||this.options.revert=="valid"&&b||this.options.revert===!0||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,b)){var e=this;$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){e._trigger("stop",a)!==!1&&e._clear()})}else this._trigger("stop",a)!==!1&&this._clear();return!1},_mouseUp:function(a){return this.options.iframeFix===!0&&$("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),$.ui.ddmanager&&$.ui.ddmanager.dragStop(this,a),$.ui.mouse.prototype._mouseUp.call(this,a)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(a){var b=!this.options.handle||!$(this.options.handle,this.element).length?!0:!1;return $(this.options.handle,this.element).find("*").andSelf().each(function(){this==a.target&&(b=!0)}),b},_createHelper:function(a){var b=this.options,c=$.isFunction(b.helper)?$(b.helper.apply(this.element[0],[a])):b.helper=="clone"?this.element.clone().removeAttr("id"):this.element;return c.parents("body").length||c.appendTo(b.appendTo=="parent"?this.element[0].parentNode:b.appendTo),c[0]!=this.element[0]&&!/(fixed|absolute)/.test(c.css("position"))&&c.css("position","absolute"),c},_adjustOffsetFromHelper:function(a){typeof a=="string"&&(a=a.split(" ")),$.isArray(a)&&(a={left:+a[0],top:+a[1]||0}),"left"in a&&(this.offset.click.left=a.left+this.margins.left),"right"in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left),"top"in a&&(this.offset.click.top=a.top+this.margins.top),"bottom"in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&$.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&$.browser.msie)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;a.containment=="parent"&&(a.containment=this.helper[0].parentNode);if(a.containment=="document"||a.containment=="window")this.containment=[a.containment=="document"?0:$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a.containment=="document"?0:$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(a.containment=="document"?0:$(window).scrollLeft())+$(a.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a.containment=="document"?0:$(window).scrollTop())+($(a.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)&&a.containment.constructor!=Array){var b=$(a.containment),c=b[0];if(!c)return;var d=b.offset(),e=$(c).css("overflow")!="hidden";this.containment=[(parseInt($(c).css("borderLeftWidth"),10)||0)+(parseInt($(c).css("paddingLeft"),10)||0),(parseInt($(c).css("borderTopWidth"),10)||0)+(parseInt($(c).css("paddingTop"),10)||0),(e?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt($(c).css("borderLeftWidth"),10)||0)-(parseInt($(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt($(c).css("borderTopWidth"),10)||0)-(parseInt($(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=b}else a.containment.constructor==Array&&(this.containment=a.containment)},_convertPositionTo:function(a,b){b||(b=this.position);var c=a=="absolute"?1:-1,d=this.options,e=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!$.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:b.top+this.offset.relative.top*c+this.offset.parent.top*c-($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:e.scrollTop())*c),left:b.left+this.offset.relative.left*c+this.offset.parent.left*c-($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*c)}},_generatePosition:function(a){var b=this.options,c=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!$.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,d=/(html|body)/i.test(c[0].tagName),e=a.pageX,f=a.pageY;if(this.originalPosition){var g;if(this.containment){if(this.relative_container){var h=this.relative_container.offset();g=[this.containment[0]+h.left,this.containment[1]+h.top,this.containment[2]+h.left,this.containment[3]+h.top]}else g=this.containment;a.pageX-this.offset.click.left<g[0]&&(e=g[0]+this.offset.click.left),a.pageY-this.offset.click.top<g[1]&&(f=g[1]+this.offset.click.top),a.pageX-this.offset.click.left>g[2]&&(e=g[2]+this.offset.click.left),a.pageY-this.offset.click.top>g[3]&&(f=g[3]+this.offset.click.top)}if(b.grid){var i=b.grid[1]?this.originalPageY+Math.round((f-this.originalPageY)/b.grid[1])*b.grid[1]:this.originalPageY;f=g?i-this.offset.click.top<g[1]||i-this.offset.click.top>g[3]?i-this.offset.click.top<g[1]?i+b.grid[1]:i-b.grid[1]:i:i;var j=b.grid[0]?this.originalPageX+Math.round((e-this.originalPageX)/b.grid[0])*b.grid[0]:this.originalPageX;e=g?j-this.offset.click.left<g[0]||j-this.offset.click.left>g[2]?j-this.offset.click.left<g[0]?j+b.grid[0]:j-b.grid[0]:j:j}}return{top:f-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():d?0:c.scrollTop()),left:e-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+($.browser.safari&&$.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():d?0:c.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(a,b,c){return c=c||this._uiHash(),$.ui.plugin.call(this,a,[b,c]),a=="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),$.Widget.prototype._trigger.call(this,a,b,c)},plugins:{},_uiHash:function(a){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),$.extend($.ui.draggable,{version:"1.8.22"}),$.ui.plugin.add("draggable","connectToSortable",{start:function(a,b){var c=$(this).data("draggable"),d=c.options,e=$.extend({},b,{item:c.element});c.sortables=[],$(d.connectToSortable).each(function(){var b=$.data(this,"sortable");b&&!b.options.disabled&&(c.sortables.push({instance:b,shouldRevert:b.options.revert}),b.refreshPositions(),b._trigger("activate",a,e))})},stop:function(a,b){var c=$(this).data("draggable"),d=$.extend({},b,{item:c.element});$.each(c.sortables,function(){this.instance.isOver?(this.instance.isOver=0,c.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(a),this.instance.options.helper=this.instance.options._helper,c.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",a,d))})},drag:function(a,b){var c=$(this).data("draggable"),d=this,e=function(a){var b=this.offset.click.top,c=this.offset.click.left,d=this.positionAbs.top,e=this.positionAbs.left,f=a.height,g=a.width,h=a.top,i=a.left;return $.ui.isOver(d+b,e+c,h,i,f,g)};$.each(c.sortables,function(e){this.instance.positionAbs=c.positionAbs,this.instance.helperProportions=c.helperProportions,this.instance.offset.click=c.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=$(d).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return b.helper[0]},a.target=this.instance.currentItem[0],this.instance._mouseCapture(a,!0),this.instance._mouseStart(a,!0,!0),this.instance.offset.click.top=c.offset.click.top,this.instance.offset.click.left=c.offset.click.left,this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top,c._trigger("toSortable",a),c.dropped=this.instance.element,c.currentItem=c.element,this.instance.fromOutside=c),this.instance.currentItem&&this.instance._mouseDrag(a)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",a,this.instance._uiHash(this.instance)),this.instance._mouseStop(a,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),c._trigger("fromSortable",a),c.dropped=!1)})}}),$.ui.plugin.add("draggable","cursor",{start:function(a,b){var c=$("body"),d=$(this).data("draggable").options;c.css("cursor")&&(d._cursor=c.css("cursor")),c.css("cursor",d.cursor)},stop:function(a,b){var c=$(this).data("draggable").options;c._cursor&&$("body").css("cursor",c._cursor)}}),$.ui.plugin.add("draggable","opacity",{start:function(a,b){var c=$(b.helper),d=$(this).data("draggable").options;c.css("opacity")&&(d._opacity=c.css("opacity")),c.css("opacity",d.opacity)},stop:function(a,b){var c=$(this).data("draggable").options;c._opacity&&$(b.helper).css("opacity",c._opacity)}}),$.ui.plugin.add("draggable","scroll",{start:function(a,b){var c=$(this).data("draggable");c.scrollParent[0]!=document&&c.scrollParent[0].tagName!="HTML"&&(c.overflowOffset=c.scrollParent.offset())},drag:function(a,b){var c=$(this).data("draggable"),d=c.options,e=!1;if(c.scrollParent[0]!=document&&c.scrollParent[0].tagName!="HTML"){if(!d.axis||d.axis!="x")c.overflowOffset.top+c.scrollParent[0].offsetHeight-a.pageY<d.scrollSensitivity?c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop+d.scrollSpeed:a.pageY-c.overflowOffset.top<d.scrollSensitivity&&(c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop-d.scrollSpeed);if(!d.axis||d.axis!="y")c.overflowOffset.left+c.scrollParent[0].offsetWidth-a.pageX<d.scrollSensitivity?c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft+d.scrollSpeed:a.pageX-c.overflowOffset.left<d.scrollSensitivity&&(c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft-d.scrollSpeed)}else{if(!d.axis||d.axis!="x")a.pageY-$(document).scrollTop()<d.scrollSensitivity?e=$(document).scrollTop($(document).scrollTop()-d.scrollSpeed):$(window).height()-(a.pageY-$(document).scrollTop())<d.scrollSensitivity&&(e=$(document).scrollTop($(document).scrollTop()+d.scrollSpeed));if(!d.axis||d.axis!="y")a.pageX-$(document).scrollLeft()<d.scrollSensitivity?e=$(document).scrollLeft($(document).scrollLeft()-d.scrollSpeed):$(window).width()-(a.pageX-$(document).scrollLeft())<d.scrollSensitivity&&(e=$(document).scrollLeft($(document).scrollLeft()+d.scrollSpeed))}e!==!1&&$.ui.ddmanager&&!d.dropBehaviour&&$.ui.ddmanager.prepareOffsets(c,a)}}),$.ui.plugin.add("draggable","snap",{start:function(a,b){var c=$(this).data("draggable"),d=c.options;c.snapElements=[],$(d.snap.constructor!=String?d.snap.items||":data(draggable)":d.snap).each(function(){var a=$(this),b=a.offset();this!=c.element[0]&&c.snapElements.push({item:this,width:a.outerWidth(),height:a.outerHeight(),top:b.top,left:b.left})})},drag:function(a,b){var c=$(this).data("draggable"),d=c.options,e=d.snapTolerance,f=b.offset.left,g=f+c.helperProportions.width,h=b.offset.top,i=h+c.helperProportions.height;for(var j=c.snapElements.length-1;j>=0;j--){var k=c.snapElements[j].left,l=k+c.snapElements[j].width,m=c.snapElements[j].top,n=m+c.snapElements[j].height;if(!(k-e<f&&f<l+e&&m-e<h&&h<n+e||k-e<f&&f<l+e&&m-e<i&&i<n+e||k-e<g&&g<l+e&&m-e<h&&h<n+e||k-e<g&&g<l+e&&m-e<i&&i<n+e)){c.snapElements[j].snapping&&c.options.snap.release&&c.options.snap.release.call(c.element,a,$.extend(c._uiHash(),{snapItem:c.snapElements[j].item})),c.snapElements[j].snapping=!1;continue}if(d.snapMode!="inner"){var o=Math.abs(m-i)<=e,p=Math.abs(n-h)<=e,q=Math.abs(k-g)<=e,r=Math.abs(l-f)<=e;o&&(b.position.top=c._convertPositionTo("relative",{top:m-c.helperProportions.height,left:0}).top-c.margins.top),p&&(b.position.top=c._convertPositionTo("relative",{top:n,left:0}).top-c.margins.top),q&&(b.position.left=c._convertPositionTo("relative",{top:0,left:k-c.helperProportions.width}).left-c.margins.left),r&&(b.position.left=c._convertPositionTo("relative",{top:0,left:l}).left-c.margins.left)}var s=o||p||q||r;if(d.snapMode!="outer"){var o=Math.abs(m-h)<=e,p=Math.abs(n-i)<=e,q=Math.abs(k-f)<=e,r=Math.abs(l-g)<=e;o&&(b.position.top=c._convertPositionTo("relative",{top:m,left:0}).top-c.margins.top),p&&(b.position.top=c._convertPositionTo("relative",{top:n-c.helperProportions.height,left:0}).top-c.margins.top),q&&(b.position.left=c._convertPositionTo("relative",{top:0,left:k}).left-c.margins.left),r&&(b.position.left=c._convertPositionTo("relative",{top:0,left:l-c.helperProportions.width}).left-c.margins.left)}!c.snapElements[j].snapping&&(o||p||q||r||s)&&c.options.snap.snap&&c.options.snap.snap.call(c.element,a,$.extend(c._uiHash(),{snapItem:c.snapElements[j].item})),c.snapElements[j].snapping=o||p||q||r||s}}}),$.ui.plugin.add("draggable","stack",{start:function(a,b){var c=$(this).data("draggable").options,d=$.makeArray($(c.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0)});if(!d.length)return;var e=parseInt(d[0].style.zIndex)||0;$(d).each(function(a){this.style.zIndex=e+a}),this[0].style.zIndex=e+d.length}}),$.ui.plugin.add("draggable","zIndex",{start:function(a,b){var c=$(b.helper),d=$(this).data("draggable").options;c.css("zIndex")&&(d._zIndex=c.css("zIndex")),c.css("zIndex",d.zIndex)},stop:function(a,b){var c=$(this).data("draggable").options;c._zIndex&&$(b.helper).css("zIndex",c._zIndex)}})}(jQuery),function($,a){var b=5;$.widget("ui.slider",$.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var a=this,c=this.options,d=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),e="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",f=c.values&&c.values.length||1,g=[];this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"+(c.disabled?" ui-slider-disabled ui-disabled":"")),this.range=$([]),c.range&&(c.range===!0&&(c.values||(c.values=[this._valueMin(),this._valueMin()]),c.values.length&&c.values.length!==2&&(c.values=[c.values[0],c.values[0]])),this.range=$("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(c.range==="min"||c.range==="max"?" ui-slider-range-"+c.range:"")));for(var h=d.length;h<f;h+=1)g.push(e);this.handles=d.add($(g.join("")).appendTo(a.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).hover(function(){c.disabled||$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")}).focus(function(){c.disabled?$(this).blur():($(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),$(this).addClass("ui-state-focus"))}).blur(function(){$(this).removeClass("ui-state-focus")}),this.handles.each(function(a){$(this).data("index.ui-slider-handle",a)}),this.handles.keydown(function(c){var d=$(this).data("index.ui-slider-handle"),e,f,g,h;if(a.options.disabled)return;switch(c.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:c.preventDefault();if(!a._keySliding){a._keySliding=!0,$(this).addClass("ui-state-active"),e=a._start(c,d);if(e===!1)return}}h=a.options.step,a.options.values&&a.options.values.length?f=g=a.values(d):f=g=a.value();switch(c.keyCode){case $.ui.keyCode.HOME:g=a._valueMin();break;case $.ui.keyCode.END:g=a._valueMax();break;case $.ui.keyCode.PAGE_UP:g=a._trimAlignValue(f+(a._valueMax()-a._valueMin())/b);break;case $.ui.keyCode.PAGE_DOWN:g=a._trimAlignValue(f-(a._valueMax()-a._valueMin())/b);break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(f===a._valueMax())return;g=a._trimAlignValue(f+h);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(f===a._valueMin())return;g=a._trimAlignValue(f-h)}a._slide(c,d,g)}).keyup(function(b){var c=$(this).data("index.ui-slider-handle");a._keySliding&&(a._keySliding=!1,a._stop(b,c),a._change(b,c),$(this).removeClass("ui-state-active"))}),this._refreshValue(),this._animateOff=!1},destroy:function(){return this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider"),this._mouseDestroy(),this},_mouseCapture:function(a){var b=this.options,c,d,e,f,g,h,i,j,k;return b.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),c={x:a.pageX,y:a.pageY},d=this._normValueFromMouse(c),e=this._valueMax()-this._valueMin()+1,g=this,this.handles.each(function(a){var b=Math.abs(d-g.values(a));e>b&&(e=b,f=$(this),h=a)}),b.range===!0&&this.values(1)===b.min&&(h+=1,f=$(this.handles[h])),i=this._start(a,h),i===!1?!1:(this._mouseSliding=!0,g._handleIndex=h,f.addClass("ui-state-active").focus(),j=f.offset(),k=!$(a.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=k?{left:0,top:0}:{left:a.pageX-j.left-f.width()/2,top:a.pageY-j.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(a,h,d),this._animateOff=!0,!0))},_mouseStart:function(a){return!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,d,e,f;return this.orientation==="horizontal"?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),d<0&&(d=0),this.orientation==="vertical"&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),this.options.values.length===2&&this.options.range===!0&&(b===0&&c>d||b===1&&c<d)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),d=this.values(b?0:1),f!==!1&&this.values(b,c,!0))):c!==this.value()&&(f=this._trigger("slide",a,{handle:this.handles[b],value:c}),f!==!1&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("change",a,c)}},value:function(a){if(arguments.length){this.options.value=this._trimAlignValue(a),this._refreshValue(),this._change(null,0);return}return this._value()},values:function(a,b){var c,d,e;if(arguments.length>1){this.options.values[a]=this._trimAlignValue(b),this._refreshValue(),this._change(null,a);return}if(!arguments.length)return this._values();if(!$.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(a):this.value();c=this.options.values,d=arguments[0];for(e=0;e<c.length;e+=1)c[e]=this._trimAlignValue(d[e]),this._change(null,e);this._refreshValue()},_setOption:function(a,b){var c,d=0;$.isArray(this.options.values)&&(d=this.options.values.length),$.Widget.prototype._setOption.apply(this,arguments);switch(a){case"disabled":b?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":this._animateOff=!0,this._refreshValue();for(c=0;c<d;c+=1)this._change(null,c);this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a),a},_values:function(a){var b,c,d;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b),b;c=this.options.values.slice();for(d=0;d<c.length;d+=1)c[d]=this._trimAlignValue(c[d]);return c},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;return Math.abs(c)*2>=b&&(d+=c>0?b:-b),parseFloat(d.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var a=this.options.range,b=this.options,c=this,d=this._animateOff?!1:b.animate,e,f={},g,h,i,j;this.options.values&&this.options.values.length?this.handles.each(function(a,h){e=(c.values(a)-c._valueMin())/(c._valueMax()-c._valueMin())*100,f[c.orientation==="horizontal"?"left":"bottom"]=e+"%",$(this).stop(1,1)[d?"animate":"css"](f,b.animate),c.options.range===!0&&(c.orientation==="horizontal"?(a===0&&c.range.stop(1,1)[d?"animate":"css"]({left:e+"%"},b.animate),a===1&&c.range[d?"animate":"css"]({width:e-g+"%"},{queue:!1,duration:b.animate})):(a===0&&c.range.stop(1,1)[d?"animate":"css"]({bottom:e+"%"},b.animate),a===1&&c.range[d?"animate":"css"]({height:e-g+"%"},{queue:!1,duration:b.animate}))),g=e}):(h=this.value(),i=this._valueMin(),j=this._valueMax(),e=j!==i?(h-i)/(j-i)*100:0,f[c.orientation==="horizontal"?"left":"bottom"]=e+"%",this.handle.stop(1,1)[d?"animate":"css"](f,b.animate),a==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[d?"animate":"css"]({width:e+"%"},b.animate),a==="max"&&this.orientation==="horizontal"&&this.range[d?"animate":"css"]({width:100-e+"%"},{queue:!1,duration:b.animate}),a==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[d?"animate":"css"]({height:e+"%"},b.animate),a==="max"&&this.orientation==="vertical"&&this.range[d?"animate":"css"]({height:100-e+"%"},{queue:!1,duration:b.animate}))}}),$.extend($.ui.slider,{version:"1.8.22"})}(jQuery)
});
deferred('$lib/jquery_webcam.js', function() {
/*! webcam plugin v1.0 (c) 2010 Robert Eisele (robert@xarg.org) http://www.xarg.org/project/jquery-webcam-plugin/ */(function($){var a={extern:null,append:!0,width:320,height:240,mode:"callback",swffile:"jscam.swf",quality:85,debug:function(){},onCapture:function(){},onTick:function(){},onSave:function(){},onCameraStart:function(){},onCameraStop:function(){},onLoad:function(){},onDetect:function(){}};window.webcam=a,$.fn.webcam=function(b){if(typeof b=="object")for(var c in a)b[c]!==undefined&&(a[c]=b[c]);var d='<object id="XwebcamXobjectX" type="application/x-shockwave-flash" data="'+a.swffile+'" width="'+a.width+'" height="'+a.height+'"><param name="movie" value="'+a.swffile+'" /><param name="FlashVars" value="mode='+a.mode+"&amp;quality="+a.quality+'" /><param name="allowScriptAccess" value="always" /></object>';null!==a.extern?$(a.extern)[a.append?"append":"html"](d):this[a.append?"append":"html"](d),(_register=function(b){var c=document.getElementById("XwebcamXobjectX");c.capture!==undefined?(a.capture=function(a){try{return c.capture(a)}catch(b){}},a.save=function(a){try{return c.save(a)}catch(b){}},a.onLoad()):0==b?a.debug("error","Flash movie not yet registered!"):window.setTimeout(_register,1e3*(4-b),b-1)})(3)}})(jQuery)
});
define("app/ui/settings/with_cropper",["module","require","exports","$lib/jquery_ui.profile.js","$lib/jquery_webcam.js","app/data/user_info"],function(module, require, exports) {
function odd(a){return a%2!=0}function Cropper(){this.dataFromBase64URL=function(a){return a.slice(a.indexOf(",")+1)},this.determineCrop=function(){var a=this.$cropImage.offset(),b=this.$cropImage.width(),c=this.$cropImage.height(),d=this.$cropMask.offset(),e=this.$cropMask.width(),f=this.$cropMask.height(),g=this.originalWidth/b,h=this.attr.maskPadding,i=d.top-a.top+h,j=d.left-a.left+h,k=d.left+h>a.left?d.left+h:a.left,l=d.top+h>a.top?d.top+h:a.top,m=d.left+e-h<a.left+b?d.left+e-h:a.left+b,n=d.top+f-h<a.top+c?d.top+f-h:a.top+c,o=Math.round(g*(j>=0?j:0)),p=Math.round(g*(i>=0?i:0)),q=this.originalWidth-o,r=this.originalHeight-p;return{maskWidth:e-2*h,maskHeight:f-2*h,imageLeft:o,imageTop:p,imageWidth:Math.min(Math.round(g*(m-k)),q),imageHeight:Math.min(Math.round(g*(n-l)),r),maskY:i<0?-i:0,maskX:j<0?-j:0}},this.determineImageType=function(a){return a.substr(a.indexOf(","),4).indexOf(",/9j")==0?"image/jpeg":"image/png"},this.compressionImageQuality=function(){var a;return userInfo.getDecider("hqImageUploads")?a=HIGH_QUALITY_COMPRESSION:userInfo.getDecider("mqImageUploads")?a=MEDIUM_QUALITY_COMPRESSION:a=LOW_QUALITY_COMPRESSION,a},this.canvasToDataURL=function(a,b){return b=="image/jpeg"?a.toDataURL("image/jpeg",this.compressionImageQuality()):a.toDataURL("image/png")},this.prepareCroppedImage=function(){this.$croppedImage=$("<img>"),this.$croppedImage.attr("src",this.$cropImage.attr("src")),this.on(this.$croppedImage,"load",this.croppedImageReady)},this.croppedImageReady=function(){this.trigger("uiCroppedImageReady")},this.computeTargetRect=function(a){var b=Math.min(Math.max(a.maskWidth,a.imageWidth),this.attr.maximumWidth),c=Math.min(Math.max(a.maskHeight,a.imageHeight),this.attr.maximumHeight);return{width:b,height:c,x:Math.round(a.maskX*(b/a.maskWidth)),y:Math.round(a.maskY*(c/a.maskHeight))}},this.clientsideCrop=function(a){var b=this.determineImageType(this.$cropImage.attr("src")),c;userInfo.getDecider("largeHeaderImageUpload")?c=this.clientsideCropLarge(a,b):c=this.clientsideCropStandard(a);var d=c.getContext("2d"),e=this.canvasToDataURL(c,b);return{fileData:this.dataFromBase64URL(e),offsetTop:0,offsetLeft:0,width:d.canvas.width,height:d.canvas.height}},this.clientsideCropStandard=function(a){var b=this.select("drawSurfaceSelector"),c=b[0].getContext("2d"),d=this.computeTargetRect(a);return this.$croppedImage.height(this.originalHeight).width(this.originalWidth),c.canvas.width=d.width,c.canvas.height=d.height,c.fillStyle="white",c.fillRect(0,0,d.width,d.height),c.drawImage(this.$croppedImage[0],a.imageLeft,a.imageTop,a.imageWidth,a.imageHeight,d.x,d.y,d.width,d.height),b[0]},this.clientsideCropLarge=function(a,b){var c=a.imageHeight,d=a.imageWidth,e=a.imageTop,f=a.imageLeft,g=this.createCanvas(d,c),h=g.getContext("2d");h.imageSmoothingEnabled=!1,h.drawImage(this.$croppedImage[0],f,e,d,c,0,0,d,c);var i=c,j=d,k=this.canvasToData(g,b);while(k==null||k.length>MAX_IMAGE_SIZE){var l=Math.ceil(j/2),m=Math.ceil(i/2),n=this.createCanvas(l,m),o=n.getContext("2d");o.imageSmoothingEnabled=!0,o.drawImage(g,0,0,j,i,0,0,l,m),k=this.canvasToData(n,b),g=n,j=l,i=m}return g},this.createCanvas=function(a,b){var c=document.createElement("canvas");return c.width=a,c.height=b,c},this.canvasToData=function(a,b){return a.width>MAX_SCALE_WIDTH||a.height>MAX_SCALE_HEIGHT?null:this.canvasToDataURL(a,b)},this.cropDimensions=function(){var a=this.$cropMask.offset();return{top:a.top,left:a.left,maskWidth:this.$cropMask.width(),maskHeight:this.$cropMask.height(),cropWidth:this.$cropMask.width()-2*this.attr.maskPadding,cropHeight:this.$cropMask.height()-2*this.attr.maskPadding}},this.bestFitImage=function(){var a=this.cropDimensions(),b=this.originalWidth,c=this.originalHeight;this.cropWidth=a.cropWidth,this.cropHeight=a.cropHeight;var d=b/c;b>=c&&a.cropWidth>=a.cropHeight&&d>=a.cropWidth/a.cropHeight?(c=a.cropHeight,b=Math.round(b*(c/this.originalHeight))):(b=a.cropWidth,c=Math.round(c*(b/this.originalWidth))),this.$cropImage.width(b).height(c).offset({top:a.maskHeight/2-c/2+a.top,left:a.maskWidth/2-b/2+a.left}),this.bestFitHeight=c,this.bestFitWidth=b},this.onDragStart=function(a,b){this.attr.imageStartOffset=this.select("cropImageSelector").offset()},this.getOffsetConstraints=function(){var a=this.$cropMask.offset(),b=this.attr.maskPadding,c=a.left+b,d=c+this.$cropMask.width()-this.$cropImage.width()-2*b,e=a.top+b,f=e+this.$cropMask.height()-this.$cropImage.height()-2*b;return{minLeft:d,maxLeft:c,minTop:f,maxTop:e,rangeLeft:c-d,rangeTop:e-f}},this.setImageOffsetConstrainedToFit=function(a){var b=this.getOffsetConstraints();this.$cropImage.offset({left:Math.min(Math.max(b.minLeft,a.left),b.maxLeft),top:Math.min(Math.max(b.minTop,a.top),b.maxTop)})},this.onDragHandler=function(a,b){this.setImageOffsetConstrainedToFit({top:this.attr.imageStartOffset.top+b.position.top-b.originalPosition.top,left:this.attr.imageStartOffset.left+b.position.left-b.originalPosition.left})},this.onDragStop=function(a,b){this.select("cropOverlaySelector").offset(this.select("cropMaskSelector").offset())},this.setScaleValue=function(a){var b=this.$cropImage.offset(),c=Math.round(b.left+this.$cropImage.width()/2),d=Math.round(b.top+this.$cropImage.height()/2),e=Math.round(this.bestFitHeight*(1+a/100)),f=Math.round(this.bestFitWidth*(1+a/100));e=odd(e)?e+=1:e,f=odd(f)?f+=1:f,this.$cropImage.height(e).width(f),this.setImageOffsetConstrainedToFit({top:Math.round(d-e/2),left:Math.round(c-f/2)})},this.onSlide=function(a,b){b.value!=this.lastScaleValue&&(this.lastScaleValue=b.value,this.setScaleValue(b.value))},this.imageLoaded=function(a,b){this.originalHeight=this.$cropImage.height(),this.originalWidth=this.$cropImage.width(),this.$slider.slider({value:0,max:100,min:0,slide:this.onSlide.bind(this)}).slider("option","value",0),this.lastScaleValue=0,this.bestFitImage(),this.select("cropOverlaySelector").draggable({drag:this.onDragHandler.bind(this),stop:this.onDragStop.bind(this),start:this.onDragStart.bind(this),containment:this.attr.cropContainerSelector,scroll:!1})},this.getNormalizedOffset=function(){var a=this.getOffsetConstraints(),b=this.$cropImage.offset();return{left:(b.left-a.minLeft)/(a.rangeLeft||1),top:(b.top-a.minTop)/(a.rangeTop||1)}},this.setNormalizedOffset=function(a){var b=this.getOffsetConstraints();this.$cropImage.offset({left:b.minLeft+b.rangeLeft*a.left,top:b.minTop+b.rangeTop*a.top})},this.setCropMetrics=function(a,b){var c=this.getNormalizedOffset();this.select("cropZoneSelector").height(b.zoneHeight).width(b.zoneWidth),this.$cropMask.css({left:b.left,top:b.top,width:b.width,height:b.height});if(this.cropWidth!=b.width||this.cropHeight!=b.height)this.bestFitImage(),this.setScaleValue(this.lastScaleValue),this.setNormalizedOffset(c)},this.after("initialize",function(){this.$cropImage=this.select("cropImageSelector"),this.$cropMask=this.select("cropMaskSelector"),this.$slider=this.select("cropperSliderSelector"),this.on(this.attr.cropImageSelector,"load",this.imageLoaded),this.on("uiSetCropMetrics",this.setCropMetrics)})}require("$lib/jquery_ui.profile.js"),require("$lib/jquery_webcam.js");var userInfo=require("app/data/user_info"),LOW_QUALITY_COMPRESSION=.75,MEDIUM_QUALITY_COMPRESSION=.85,HIGH_QUALITY_COMPRESSION=.9,MAX_SCALE_HEIGHT=4096,MAX_SCALE_WIDTH=4096,MAX_IMAGE_SIZE=2048e3;module.exports=Cropper
});
define("app/ui/settings/with_webcam",["module","require","exports","$lib/jquery_ui.profile.js","$lib/jquery_webcam.js"],function(module, require, exports) {
function Webcam(){this.doJsCam=function(){$(this.attr.webcamContainerSelector).webcam({width:320,height:240,mode:"callback",swffile:"/flash/jscam.swf",onLoad:this.jsCamLoad.bind(this),onCameraStart:this.jsCamCameraStart.bind(this),onCameraStop:this.jsCamCameraStop.bind(this),onCapture:this.jsCamCapture.bind(this),onSave:this.jsCamSave.bind(this),debug:this.jsCamDebug})},this.jsCamLoad=function(){var a=this.select("webcamCanvasSelector")[0].getContext("2d");this.image=a.getImageData(0,0,320,240),this.pos=0},this.jsCamCameraStart=function(){this.select("captureWebcamSelector").attr("disabled",!1)},this.jsCamCameraStop=function(){this.select("captureWebcamSelector").attr("disabled",!0)},this.jsCamCapture=function(){window.webcam.save()},this.jsCamSave=function(a){var b=this.select("webcamCanvasSelector")[0].getContext("2d"),c=a.split(";"),d=this.image;for(var e=0;e<320;e++){var f=parseInt(c[e]);d.data[this.pos+0]=f>>16&255,d.data[this.pos+1]=f>>8&255,d.data[this.pos+2]=f&255,d.data[this.pos+3]=255,this.pos+=4}if(this.pos>=307200){var g=this.select("webcamCanvasSelector")[0],h=this.select("cropImageSelector")[0];b.putImageData(d,0,0),h.src=g.toDataURL("image/png"),this.pos=0,this.trigger("jsCamCapture")}},this.jsCamDebug=function(a,b){}}require("$lib/jquery_ui.profile.js"),require("$lib/jquery_webcam.js"),module.exports=Webcam
});
define("app/ui/with_verify_upload_type",["module","require","exports"],function(module, require, exports) {
function withVerifyUploadType(){this.verifyUploadType=function(a){return function(b,c){if(c&&(c.uploadType||c.sourceEventData&&c.sourceEventData.uploadType)==this.attr.uploadType)return a.apply(this,arguments)}}}module.exports=withVerifyUploadType
});
define("app/utils/is_showing_avatar_options",["module","require","exports"],function(module, require, exports) {
module.exports=function(){return $("body").hasClass("show-avatar-options")}
});
define("app/ui/dialogs/profile_image_upload_dialog",["module","require","exports","core/component","app/ui/settings/with_cropper","app/ui/with_dialog","app/ui/settings/with_webcam","app/ui/with_verify_upload_type","app/utils/is_showing_avatar_options","core/i18n","$lib/jquery_ui.profile.js","$lib/jquery_webcam.js"],function(module, require, exports) {
function profileImageUpload(){this.defaultAttrs({webcamTitle:_('\u306f\u3044\u3001\u30c1\u30fc\u30ba!'),titleSelector:".modal-title",profileImageCropDivSelector:".image-upload-crop",profileImageWebcamDivSelector:".image-upload-webcam",cancelSelector:".profile-image-cancel",saveSelector:".profile-image-save",cropperSliderSelector:".cropper-slider",cropImageSelector:".crop-image",cropMaskSelector:".cropper-mask",cropOverlaySelector:".cropper-overlay",cropZoneSelector:".crop-zone",captureWebcamSelector:".profile-image-capture-webcam",webcamContainerSelector:".webcam-container",webcamCanvasSelector:".webcam-canvas",imageNameSelector:"#choose-photo div.photo-selector input.file-name",imageDataSelector:"#choose-photo div.photo-selector input.file-data",imageUploadSpinnerSelector:".image-upload-spinner",maskPadding:40,top:50,uploadType:"",drawSurfaceSelector:".drawsurface",showSuccessMessage:!0,maximumWidth:256,maximumHeight:256,fileName:"",savingClass:"saving",isAvatarWhenShowingAvatarOptions:!0}),this.showCropper=function(a){this.setTitle(this.attr.originalTitle),this.select("captureWebcamSelector").hide(),this.select("saveSelector").show(),this.attr.fileName=a,this.clearForm(),document.body.focus(),this.trigger(this.$dialog,"uiDialogContentChanged"),this.trigger("uiShowingCropper",{scribeElement:this.getScribeElement()})},this.setScribeElement=function(a){this.scribeElement=a},this.getScribeElement=function(){return this.scribeElement||"upload"},this.reset=function(){this.select("cropImageSelector").attr("src",""),this.select("cropImageSelector").attr("style",""),this.select("webcamContainerSelector").empty(),this.select("cancelSelector").show(),this.select("saveSelector").attr("disabled",!1).hide(),this.$node.removeClass(this.attr.savingClass),this.select("profileImageWebcamDivSelector").hide(),this.select("profileImageCropDivSelector").hide(),this.select("captureWebcamSelector").hide()},this.swapVisibility=function(a,b){this.$node.find(a).hide(),this.$node.find(b).show()},this.haveImageSelected=function(a,b){var c=$(this.attr.imageNameSelector).attr("value"),d="data:image/jpeg;base64,"+$(this.attr.imageDataSelector).attr("value");this.gotImageData(b.uploadType,c,d),this.trigger("uiCloseDropdowns")},this.gotImageData=function(a,b,c,d){a!=="background"&&(this.openDialog(),this.trigger("uiUploadReceived"),this.select("cropImageSelector").attr("src",c),this.select("profileImageCropDivSelector").show(),this.setScribeElement("upload"),this.showCropper(b),d&&this.trigger("uiDropped"))},this.openDialog=function(){this.open(),this.reset()},this.setTitle=function(a){this.select("titleSelector").text(a)},this.showWebcam=function(a,b){this.setTitle(this.attr.webcamTitle),this.openDialog(),this.select("profileImageWebcamDivSelector").show(),this.select("captureWebcamSelector").show(),this.doJsCam(),this.trigger("uiShowingWebcam")},this.takePhoto=function(){webcam.capture()},this.webcamCaptured=function(){this.swapVisibility(this.attr.profileImageWebcamDivSelector,this.attr.profileImageCropDivSelector),this.setScribeElement("webcam"),$(this.attr.imageDataSelector).attr("value",this.dataFromBase64URL(this.select("cropImageSelector").attr("src"))),$(this.attr.imageNameSelector).attr("value","webcam-cap.png"),this.showCropper()},this.save=function(a,b){if(this.$node.hasClass(this.attr.savingClass))return;return this.prepareCroppedImage(),a.preventDefault(),!1},this.readyToCrop=function(){var a=this.determineCrop(),b=this.clientsideCrop(a);b.fileName=this.attr.fileName,b.uploadType=this.attr.uploadType,b.scribeElement=this.getScribeElement(),this.trigger("uiImageSave",b),this.enterSavingState()},this.enterSavingState=function(){this.select("imageUploadSpinnerSelector").css("height",this.select("profileImageCropDivSelector").height()),this.$node.addClass(this.attr.savingClass),this.select("saveSelector").attr("disabled",!0),this.select("cancelSelector").hide()},this.uploadSuccess=function(a,b){if(this.attr.showSuccessMessage){var c={avatar:_('\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u753b\u50cf'),header:_('\u30d8\u30c3\u30c0\u30fc'),background:_('\u80cc\u666f')},d=c[this.attr.uploadType]||this.attr.uploadType;this.trigger("uiAlertBanner",{message:_('{{uploadType}}\u304c\u516c\u958b\u3055\u308c\u307e\u3057\u305f\u3002',{uploadType:d})})}this.trigger("uiProfileImagePublished",{scribeElement:this.getScribeElement()}),this.close()},this.uploadFailed=function(a,b){this.trigger("uiProfileImageDialogFailure",{scribeElement:this.getScribeElement()}),this.trigger("uiAlertBanner",{message:b.message}),this.close()},this.clearForm=function(){$(this.attr.imageDataSelector).removeAttr("value"),$(this.attr.imageNameSelector).removeAttr("value")},this.interceptGotProfileImageData=function(a,b){this.attr.isAvatarWhenShowingAvatarOptions&&b.uploadType=="header"&&isShowingAvatarOptions()&&(b.uploadType="avatar"),b.uploadType==this.attr.uploadType&&this.gotImageData(b.uploadType,b.name,b.contents,b.wasDropped)},this.after("initialize",function(){this.attr.originalTitle=this.select("titleSelector").text(),this.on(document,"uiCropperWebcam",this.verifyUploadType(this.showWebcam)),this.on(document,"uiImagePickerFileReady",this.verifyUploadType(this.haveImageSelected)),this.on("jsCamCapture",this.webcamCaptured),this.on(this.select("captureWebcamSelector"),"click",this.takePhoto),this.on(this.select("saveSelector"),"click",this.save),this.on("uiCroppedImageReady",this.readyToCrop),this.on(document,"dataSaveImageSuccess",this.verifyUploadType(this.uploadSuccess)),this.on(document,"dataSaveImageFailure",this.verifyUploadType(this.uploadFailed)),this.on(document,"uiGotProfileImageData",this.interceptGotProfileImageData),this.on(this.attr.cancelSelector,"click",this.close),this.on("uiDialogClosed",function(){this.clearForm(),this.reset(),this.trigger("uiProfileImageDialogClose")})})}var defineComponent=require("core/component"),withCropper=require("app/ui/settings/with_cropper"),withDialog=require("app/ui/with_dialog"),withWebcam=require("app/ui/settings/with_webcam"),withVerifyUploadType=require("app/ui/with_verify_upload_type"),isShowingAvatarOptions=require("app/utils/is_showing_avatar_options"),_=require("core/i18n");require("$lib/jquery_ui.profile.js"),require("$lib/jquery_webcam.js"),module.exports=defineComponent(profileImageUpload,withCropper,withDialog,withWebcam,withVerifyUploadType)
});
define("app/ui/dialogs/profile_edit_error_dialog",["module","require","exports","core/component","core/i18n","app/ui/with_dialog"],function(module, require, exports) {
function profileEditErrorDialog(){this.defaultAttrs({okaySelector:".ok-btn",messageSelector:".profile-message"}),this.closeDialog=function(a,b){this.close()},this.showError=function(a,b){this.select("messageSelector").html(b.message),this.open()},this.after("initialize",function(){this.on(document,"uiShowProfileEditError",this.showError),this.on("click",{okaySelector:this.closeDialog})})}var defineComponent=require("core/component"),_=require("core/i18n"),withDialog=require("app/ui/with_dialog"),ProfileEditErrorDialog=defineComponent(profileEditErrorDialog,withDialog);module.exports=ProfileEditErrorDialog
});
define("app/ui/dialogs/profile_confirm_image_delete_dialog",["module","require","exports","core/component","app/ui/with_dialog","app/ui/with_verify_upload_type"],function(module, require, exports) {
function profileConfirmImageDeleteDialog(){this.defaultAttrs({removeSelector:".ok-btn",cancelSelector:".cancel-btn",uploadType:""}),this.removeImage=function(){this.disableButtons(),this.trigger("uiDeleteImage",{uploadType:this.attr.uploadType})},this.triggerHideDeleteLink=function(){this.trigger("uiHideDeleteLink",{uploadType:this.attr.uploadType})},this.disableButtons=function(){this.select("removeSelector").attr("disabled",!0),this.select("cancelSelector").stop(!0,!0).fadeOut()},this.enableButtons=function(){this.select("removeSelector").removeAttr("disabled"),this.select("cancelSelector").stop(!0,!0).show()},this.after("initialize",function(){this.on(document,"uiConfirmDeleteImage",this.verifyUploadType(this.open)),this.on(document,"dataDeleteImageSuccess",this.verifyUploadType(this.close)),this.on(document,"dataDeleteImageSuccess",this.verifyUploadType(this.triggerHideDeleteLink)),this.on(document,"dataDeleteImageFailure",this.verifyUploadType(this.enableButtons)),this.on("uiDialogClosed",this.enableButtons),this.on("click",{cancelSelector:this.close,removeSelector:this.removeImage})})}var defineComponent=require("core/component"),withDialog=require("app/ui/with_dialog"),withVerifyUploadType=require("app/ui/with_verify_upload_type");module.exports=defineComponent(profileConfirmImageDeleteDialog,withDialog,withVerifyUploadType)
});
define("app/ui/droppable_image",["module","require","exports","core/component","app/ui/with_drop_events","app/utils/image"],function(module, require, exports) {
function droppableImage(){this.defaultAttrs({uploadType:""}),this.triggerGotProfileImageData=function(a,b){this.trigger("uiGotProfileImageData",{name:a,contents:b,uploadType:this.attr.uploadType,wasDropped:!0})},this.getDroppedImageData=function(a,b){if(!this.editing)return;a.stopImmediatePropagation();var c=b.file;image.getFileData(c.name,c,this.triggerGotProfileImageData.bind(this))},this.allowDrop=function(a){this.editing=a.type==="uiEditProfileStart"},this.after("initialize",function(){this.editing=!1,this.on(document,"uiEditProfileStart uiEditProfileEnd",this.allowDrop),this.on("uiDrop",this.getDroppedImageData)})}var defineComponent=require("core/component"),withDropEvents=require("app/ui/with_drop_events"),image=require("app/utils/image");module.exports=defineComponent(droppableImage,withDropEvents)
});
define("app/data/inline_edit_scribe",["module","require","exports","core/component","core/utils","app/data/with_scribe"],function(module, require, exports) {
function inlineEditScribe(){this.defaultAttrs({scribeContext:{component:"inline_edit"}}),this.scribeAction=function(a){var b=utils.merge(this.attr.scribeContext,{action:a});return function(a,c){this.scribe(b,c)}},this.after("initialize",function(){this.on("uiEditProfileStart",this.scribeAction("edit")),this.on("uiEditProfileCancel",this.scribeAction("cancel")),this.on("dataInlineEditSaveSuccess",this.scribeAction("success")),this.on("dataInlineEditSaveError",this.scribeAction("error"))})}var defineComponent=require("core/component"),utils=require("core/utils"),withScribe=require("app/data/with_scribe"),InlineEditScribe=defineComponent(inlineEditScribe,withScribe);module.exports=InlineEditScribe
});
define("app/data/settings/profile_image_upload_scribe",["module","require","exports","core/component","core/utils","app/data/with_scribe"],function(module, require, exports) {
function profileImageUploadScribe(){this.scribeEvent=function(a,b){this.scribe(utils.merge(a.scribeContext,b))},this.after("initialize",function(){this.scribeOnEvent("uiUploadReceived",{element:"upload",action:"complete"}),this.scribeOnEvent("uiShowingWebcam",{element:"webcam",action:"impression"}),this.scribeOnEvent("jsCamCapture",{element:"webcam",action:"complete"}),this.scribeOnEvent("uiProfileImageDialogClose",{action:"close"}),this.on("uiImageSave",function(a,b){this.scribeEvent(b,{element:"crop_"+b.scribeElement,action:"complete"})}),this.on("uiShowingCropper",function(a,b){this.scribeEvent(b,{element:"crop_"+b.scribeElement,action:"impression"})}),this.on("uiProfileImagePublished",function(a,b){this.scribeEvent(b,{element:"save_"+b.scribeElement,action:"complete"})}),this.on("uiProfileImageDialogFailure",function(a,b){this.scribeEvent(b,{element:"save_"+b.scribeElement,action:"failure"})})})}var defineComponent=require("core/component"),utils=require("core/utils"),withScribe=require("app/data/with_scribe"),ProfileImageUploadScribe=defineComponent(profileImageUploadScribe,withScribe);module.exports=ProfileImageUploadScribe
});
define("app/data/drag_and_drop_scribe",["module","require","exports","core/component","core/utils","app/data/with_scribe"],function(module, require, exports) {
function dragAndDropScribe(){this.after("initialize",function(){this.scribeOnEvent("uiDropped",{action:"drag_and_drop"})})}var defineComponent=require("core/component"),utils=require("core/utils"),withScribe=require("app/data/with_scribe");module.exports=defineComponent(dragAndDropScribe,withScribe)
});
define("app/ui/settings/change_photo",["module","require","exports","core/component","app/ui/with_dropdownmenu","app/data/with_scribe","app/ui/with_verify_upload_type","app/utils/image","core/utils","core/i18n"],function(module, require, exports) {
function changePhoto(){this.defaultAttrs({fileInputSelector:".file-input",uploadType:"avatar",swfSelector:"div.webcam-detect.swf-container",chooseExistingSelector:"#photo-choose-existing",chooseWebcamSelector:"#photo-choose-webcam",deleteImageSelector:"#photo-delete-image",caretSelector:".dropdown-caret",photoSelector:"div.photo-selector",showDeleteSuccessMessage:!0,alwaysOpen:!1,confirmDelete:!1,defaultToFileInputOpen:!1,supportsAutoOpen:!0}),this.webcamDetectorSwfPath="/flash/WebcamDetector.swf",this.isUsingFlashUploader=function(){return image.hasFlash()&&!image.hasFileReader()},this.isFirefox36=function(){var a=$.browser;return a.mozilla&&a.version.slice(0,3)=="1.9"},this.needsMenuHeldOpen=function(){return this.isUsingFlashUploader()||this.isFirefox36()},this.openWebCamDialog=function(a){a.preventDefault(),this.needsMenuHeldOpen()&&(this.preventMenuClose=!1),this.trigger("uiCropperWebcam",{uploadType:this.attr.uploadType})},this.webcamDetected=function(){this.updateDropdownItemVisibility(this.select("chooseWebcamSelector"),!0)},this.dropdownOpened=function(a,b){var c=b&&b.scribeContext||this.attr.eventData.scribeContext;this.scribe(utils.merge(c,{action:"open"})),this.needsMenuHeldOpen()&&(this.preventMenuClose=!0)},this.setupWebcamDetection=function(){var a=this.select("swfSelector");image.hasFlash()&&(window.webcam&&(window.webcam.onDetect=this.webcamDetected.bind(this)),a.css("width","0"),a.css("height","0"),a.css("overflow","hidden"),a.flash({swf:this.webcamDetectorSwfPath,height:1,width:1,wmode:"transparent",AllowScriptAccess:"sameDomain"}))},this.deleteImage=function(){if(this.attr.uploadType!=="background"){this.needsMenuHeldOpen()&&(this.preventMenuClose=!1),this.attr.confirmDelete&&(this.preventMenuClose=!0);var a=this.attr.confirmDelete?"uiConfirmDeleteImage":"uiDeleteImage";this.trigger(a,{uploadType:this.attr.uploadType})}else this.hideFileName();this.attr.confirmDelete||this.hideDeleteLink()},this.handleSaveImageSuccess=function(a,b){b.message&&this.attr.showSaveSuccessMessage&&this.trigger("uiAlertBanner",b),this.showDeleteLink()},this.handleSaveImageFailure=function(a,b){b.message=b.message||_('\u753b\u50cf\u306e\u4fdd\u5b58\u4e2d\u306b\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u518d\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002',this.attr),this.trigger("uiAlertBanner",b)},this.handleDeleteImageSuccess=function(a,b){b.message&&this.attr.showDeleteSuccessMessage&&this.trigger("uiAlertBanner",b)},this.handleDeleteImageFailure=function(a,b){b.message=b.message||_('\u753b\u50cf\u306e\u524a\u9664\u4e2d\u306b\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u518d\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002',this.attr),this.trigger("uiAlertBanner",b),this.showDeleteLink()},this.showDeleteLinkForTargetedButton=function(a,b){b.uploadType=="background"&&this.showDeleteLink()},this.showDeleteLink=function(a,b){this.updateDropdownItemVisibility(this.select("deleteImageSelector"),!0)},this.hideDeleteLink=function(a,b){this.updateDropdownItemVisibility(this.select("deleteImageSelector"),!1)},this.showFileName=function(a,b){this.$node.siblings(".display-file-requirement").hide(),this.$node.siblings(".display-file-name").text(b.fileName).show()},this.hideFileName=function(){this.$node.siblings(".display-file-requirement").show(),this.$node.siblings(".display-file-name").hide()},this.updateDropdownItemVisibility=function(a,b){a.toggleClass("u-hidden",!b),this.updateMenuHierarchy()},this.upliftFilePicker=function(){var a=this.select("photoSelector");this.select("togglerSelector").hide(),a.find("button").attr("disabled",!1),a.appendTo(this.$node)},this.moveFilePickerBackIntoMenu=function(){var a=this.select("photoSelector");a.appendTo(this.select("chooseExistingSelector")),this.select("togglerSelector").show()},this.updateMenuHierarchy=function(){if(this.attr.alwaysOpen)return;this.availableDropdownItems().length==1?this.upliftFilePicker():this.moveFilePickerBackIntoMenu()},this.availableDropdownItems=function(){return this.select("menuItemSelector").filter(function(){return $(this).css("display")!="none"})},this.addCaretHover=function(){this.select("caretSelector").addClass("hover")},this.removeCaretHover=function(){this.select("caretSelector").removeClass("hover")},this.handleCloseRequest=function(a){(this.attr.alwaysOpen||this.preventMenuClose)&&a.preventDefault()},this.handleOpenRequest=function(a){var b=this.availableDropdownItems();b.length==1&&this.attr.supportsAutoOpen&&(a.preventDefault(),this.attr.defaultToFileInputOpen?(this.trigger("uiEditProfileHideOptions"),b.find(this.attr.fileInputSelector).click()):b.click())},this.after("initialize",function(){this.attr.uploadType=="avatar"&&this.setupWebcamDetection(),this.on(document,"uiImagePickerFileReady",this.verifyUploadType(this.showDeleteLinkForTargetedButton)),this.on(document,"uiFileNameReady",this.verifyUploadType(this.showFileName)),this.on(document,"uiHideDeleteLink",this.verifyUploadType(this.hideDeleteLink)),this.on(document,"dataSaveImageSuccess",this.verifyUploadType(this.handleSaveImageSuccess)),this.on(document,"dataSaveImageFailure",this.verifyUploadType(this.handleSaveImageFailure)),this.on(document,"dataDeleteImageSuccess",this.verifyUploadType(this.handleDeleteImageSuccess)),this.on(document,"dataDeleteImageFailure",this.verifyUploadType(this.handleDeleteImageFailure)),this.on("uiDropdownOpened",this.dropdownOpened),this.on("uiDropdownOpenRequested",this.handleOpenRequest),this.on("uiDropdownCloseRequested",this.handleCloseRequest),this.on("click",{chooseWebcamSelector:this.openWebCamDialog,deleteImageSelector:this.deleteImage}),this.on("mouseover focusin",{firstMenuItemSelector:this.addCaretHover}),this.on("mouseout focusout",{firstMenuItemSelector:this.removeCaretHover}),this.updateMenuHierarchy()}),this.before("teardown",function(){delete window.webcam})}var defineComponent=require("core/component"),withDropdownMenu=require("app/ui/with_dropdownmenu"),withScribe=require("app/data/with_scribe"),withVerifyUploadType=require("app/ui/with_verify_upload_type"),image=require("app/utils/image"),utils=require("core/utils"),_=require("core/i18n");module.exports=defineComponent(changePhoto,withDropdownMenu,withScribe,withVerifyUploadType)
});
define("app/ui/image_uploader",["module","require","exports","core/component","app/utils/image","app/ui/with_image_selection","app/data/with_scribe","core/i18n"],function(module, require, exports) {
function imageUploader(){this.defaults={swfHeight:30,swfWidth:274,uploadType:"",fileNameTextSelector:".photo-file-name"},this.updateFileNameText=function(a,b){var c=this.truncate(b.fileName,18);this.select("fileNameSelector").val(b.fileName),this.select("fileNameTextSelector").text(c),this.trigger("uiFileNameReady",{fileName:c})},this.addFileError=function(a){a=="tooLarge"?this.trigger("uiAlertBanner",{message:this.attr.fileTooBigMessage}):(a=="notImage"||a=="ioError")&&this.trigger("uiAlertBanner",{message:_('\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002')}),this.scribe({component:"profile_image",element:"upload",action:"failure"}),typeof this.attr.onError=="function"&&this.attr.onError(),this.reset()},this.gotImageData=function(a,b){this.gotResizedImageData(a,b)},this.truncate=function(a,b){if(a.length<=b)return a;var c=Math.ceil(b/2),d=Math.floor(b/2),e=a.substr(0,c),f=a.substr(a.length-d,d);return e+"â€¦"+f},this.loadSwf=function(a,b){image.loadPhotoSelectorSwf(this.select("swfSelector"),a,b,this.attr.swfHeight,this.attr.swfWidth,this.attr.maxSizeInBytes)},this.initializeButton=function(){this.select("buttonSelector").attr("disabled",!1)},this.resetUploader=function(){this.select("fileNameSelector").val(""),this.select("fileNameTextSelector").text(_('\u30d5\u30a1\u30a4\u30eb\u304c\u9078\u629e\u3055\u308c\u3066\u3044\u307e\u305b\u3093'))},this.after("initialize",function(){this.maxSizeInBytes=this.attr.maxSizeInBytes,this.initializeButton(),this.on(this.$node,"uiTweetBoxShowPreview",this.updateFileNameText),this.on("uiResetUploader",this.resetUploader)})}var defineComponent=require("core/component"),image=require("app/utils/image"),withImageSelection=require("app/ui/with_image_selection"),withScribe=require("app/data/with_scribe"),_=require("core/i18n"),ImageUploader=defineComponent(imageUploader,withImageSelection,withScribe);module.exports=ImageUploader
});
define("app/ui/inline_profile_editing_initializor",["module","require","exports","core/component","app/utils/image"],function(module, require, exports) {
function inlineProfileEditingInitializor(){this.defaultAttrs({profileEditingCSSBundle:"",testForCssSelector:null,retryDelay:100,retryMax:20}),this.supportsInlineEditing=function(){return image.supportsCropper()},this.initializeInlineProfileEditing=function(a,b){this.supportsInlineEditing()?using("css!"+this.attr.profileEditingCSSBundle,this.testForCssLoaded.bind(this,b.scribeElement)):this.navigateToOldSettingsPage()},this.editHeader=function(a,b){$(document).one("uiEditProfileStart",this.showHeaderOptions.bind(this)),this.trigger("uiEditProfileInitialize",{scribeElement:b.scribeElement})},this.showHeaderOptions=function(){this.trigger("uiShowEditHeaderOptions")},this.navigateToOldSettingsPage=function(){this.trigger("uiNavigate",{href:"/settings/profile"})},this.testForCssLoaded=function(a){!this.attr.testForCssSelector||$(this.attr.testForCssSelector).length?this.triggerStart(a):this.retryCount<this.attr.retryMax?(this.retryCount++,setTimeout(this.testForCssLoaded.bind(this,a),this.attr.retryDelay)):this.navigateToOldSettingsPage()},this.triggerStart=function(a){this.trigger("uiEditProfileStart",{scribeContext:{element:a}})},this.after("initialize",function(){this.retryCount=0,this.on(document,"uiEditProfileInitialize",this.initializeInlineProfileEditing),this.on(document,"uiEditProfileInitializeAndFocusOnHeaderOptions",this.editHeader)})}var defineComponent=require("core/component"),image=require("app/utils/image");module.exports=defineComponent(inlineProfileEditingInitializor)
});
define("app/utils/hide_or_show_divider",["module","require","exports"],function(module, require, exports) {
module.exports=function(b,c,d,e){var f=b.find(c),g=!!$.trim(b.find(d).text()),h=!!$.trim(b.find(e).text());g&&h?f.show():f.hide()}
});
define("app/ui/with_inline_image_options",["module","require","exports","core/compose","app/ui/with_upload_photo_affordance","app/utils/is_showing_avatar_options"],function(module, require, exports) {
function withInlineImageOptions(){compose.mixin(this,[withUploadPhotoAffordance]),this.defaultAttrs({editHeaderSelector:".edit-header-target",editAvatarSelector:".profile-picture",profileHeaderMaskSelector:".profile-header-mask",cancelOptionsSelector:".cancel-options",changePhotoSelector:"#choose-photo",changeHeaderSelector:"#choose-header",canToggleHeaderOptions:!1,improvedProfileImageUploadFlow:!1}),this.isShowingHeaderOptions=function(){return this.$body.hasClass("show-header-options")},this.optionsEnabled=function(){this.canShowOptions=!0},this.optionsDisabled=function(){this.canShowOptions=!1},this.toggleAvatarOptions=function(a){a.preventDefault(),this.hideHeaderOptions(),isShowingAvatarOptions()?this.hideAvatarOptions():this.showAvatarOptions()},this.showAvatarOptions=function(){this.canShowOptions&&!isShowingAvatarOptions()&&(this.$body.addClass("show-avatar-options"),this.trigger(this.select("changePhotoSelector"),"uiShouldShowDropdown"))},this.openImageDialog=function(){this.trigger(this.select("changePhotoSelector"),"uiOpenImageDialog")},this.hideAvatarOptions=function(){this.$body.removeClass("show-avatar-options"),this.trigger(document,"uiForceDropdownClosed")},this.toggleHeaderOptions=function(a){a.preventDefault(),this.hideAvatarOptions(),this.isShowingHeaderOptions()?this.hideHeaderOptions():this.showHeaderOptions()},this.showHeaderOptions=function(){this.canShowOptions&&!this.$body.hasClass("show-header-options")&&(this.$body.addClass("show-header-options"),this.trigger(this.select("changeHeaderSelector"),"uiShouldShowDropdown"))},this.hideHeaderOptions=function(){this.$body.removeClass("show-header-options"),this.trigger(document,"uiForceDropdownClosed")},this.hideOptions=function(){this.hideHeaderOptions(),this.hideAvatarOptions()},this.after("initialize",function(){this.$body=$("body"),this.on("click",{profileHeaderMaskSelector:this.hideOptions,cancelOptionsSelector:this.hideOptions}),this.attr.improvedProfileImageUploadFlow?(this.on("click",{editAvatarSelector:this.openImageDialog,editHeaderSelector:this.openImageDialog}),this.on(document,"uiShowEditAvatarOptions uiShowEditHeaderOptions",this.openImageDialog)):(this.on("click",{editAvatarSelector:this.toggleAvatarOptions,editHeaderSelector:this.attr.canToggleHeaderOptions?this.toggleHeaderOptions:this.showHeaderOptions}),this.on(document,"uiShowEditAvatarOptions",this.showAvatarOptions),this.on(document,"uiShowEditHeaderOptions",this.showHeaderOptions)),this.attr.canToggleHeaderOptions||this.on("uiDropdownCloseRequested",function(a){this.isShowingHeaderOptions()&&a.preventDefault()}),this.on("uiEditProfileStart",this.optionsEnabled),this.on("uiEditProfileEnd",this.optionsDisabled),this.on("uiProfileHeaderUpdated uiProfileAvatarUpdated uiEditProfileEnd uiEditProfileHideOptions",this.hideOptions),this.on(document,"uiShortcutEsc",this.hideOptions)})}var compose=require("core/compose"),withUploadPhotoAffordance=require("app/ui/with_upload_photo_affordance"),isShowingAvatarOptions=require("app/utils/is_showing_avatar_options");module.exports=withInlineImageOptions
});
define("app/ui/with_inline_image_editing",["module","require","exports","core/compose","app/utils/hide_or_show_divider","app/ui/with_inline_image_options"],function(module, require, exports) {
function withInlineImageEditing(){compose.mixin(this,[withInlineImageOptions]),this.defaultAttrs({headerImageUploadDialogSelector:"#header_image_upload_dialog",headerCropperSelector:"#header_image_upload_dialog .cropper-mask",avatarSelector:".avatar:first",avatarContainerSelector:".profile-picture:first",profileHeaderInnerSelector:".profile-header-inner:first",avatarPlaceholderSelector:".profile-picture-placeholder",avatarHiddenClass:"hidden",removeFromPreview:".profile-editing-dialogs, .edit-header-target, input, label, textarea, .controls, .inline-edit-icon",avatarEditingSelector:".ProfileAvatarEditing",previewHeaderUploading:!0,profileHeaderEditingClass:"profile-header-editing",updateHeaderSizeValue:"100% 100%",headerEditingSelector:".ProfileHeaderEditing",hasHeaderClass:"is-withHeader"}),this.editHeaderModeOn=function(){this.addPreviewToHeaderUpload(),this.$body.addClass(this.attr.profileHeaderEditingClass),this.hideHeaderOptions()},this.editHeaderModeOff=function(){this.$body.removeClass(this.attr.profileHeaderEditingClass),this.removeHeaderPreview()},this.removeHeaderPreview=function(){this.$headerPreview&&this.$headerPreview.remove()},this.addPreviewToHeaderUpload=function(){if(!this.attr.previewHeaderUploading)return;this.removeHeaderPreview(),this.trigger("uiNeedsTextPreview");var a=this.$headerPreview=this.$node.clone();a.find(this.attr.profileHeaderInnerSelector).css("background-image","none"),hideOrShowDivider(a,this.attr.dividerSelector,this.attr.locationSelector,this.attr.urlProfileFieldSelector),a.find(this.attr.removeFromPreview).remove(),this.select("headerCropperSelector").prepend(a)},this.updateImage=function(a,b){var c="data:image/jpeg;base64,"+b.sourceEventData.fileData;this.isOfType("header",b)&&this.updateHeader(c),this.isOfType("avatar",b)&&(this.select("avatarSelector").attr("src",c),this.showAvatar())},this.updateHeader=function(a){this.attr.profileHeaderImageSelector?this.select("profileHeaderImageSelector").attr("src",a):this.select("profileHeaderInnerSelector").css({"background-size":this.attr.updateHeaderSizeValue,"background-image":"url("+a+")"}),this.trigger("uiProfileHeaderUpdated"),this.select("headerEditingSelector").addClass(this.attr.hasHeaderClass)},this.useDefaultHeader=function(){var a=this.select("profileHeaderInnerSelector").attr("data-default-background-image");this.updateHeader(a),this.select("headerEditingSelector").removeClass(this.attr.hasHeaderClass)},this.hasHeader=function(){return this.select("headerEditingSelector").hasClass(this.attr.hasHeaderClass)},this.showAvatar=function(){this.select("avatarContainerSelector").removeClass(this.attr.avatarHiddenClass),this.select("avatarPlaceholderSelector").addClass(this.attr.avatarHiddenClass),this.trigger("uiProfileAvatarUpdated"),this.select("avatarEditingSelector").addClass("is-withAvatar")},this.showAvatarPlaceholder=function(){this.select("avatarContainerSelector").addClass(this.attr.avatarHiddenClass),this.select("avatarPlaceholderSelector").removeClass(this.attr.avatarHiddenClass),this.trigger("uiProfileAvatarUpdated"),this.select("avatarEditingSelector").removeClass("is-withAvatar")},this.showDefaultImage=function(a,b){this.isOfType("avatar",b)&&this.showAvatarPlaceholder(),this.isOfType("header",b)&&this.useDefaultHeader()},this.isOfType=function(a,b){return b&&b.sourceEventData&&b.sourceEventData.uploadType===a},this.showLargeCanopy=function(){this.trigger("uiShowLargeCanopy")},this.showNormalCanopy=function(){this.trigger(this.hasHeader()?"uiShowLargeCanopy":"uiShowSmallCanopy")},this.after("initialize",function(){this.$body=$("body"),this.on("uiDialogOpened",{headerImageUploadDialogSelector:this.editHeaderModeOn}),this.on("uiDialogClosed",{headerImageUploadDialogSelector:this.editHeaderModeOff}),this.on(document,"dataSaveImageSuccess",this.updateImage),this.on(document,"dataDeleteImageSuccess",this.showDefaultImage),this.on(document,"uiEditProfileStart",this.showLargeCanopy),this.on(document,"uiEditProfileEnd",this.showNormalCanopy)})}var compose=require("core/compose"),hideOrShowDivider=require("app/utils/hide_or_show_divider"),withInlineImageOptions=require("app/ui/with_inline_image_options");module.exports=withInlineImageEditing
});
define("app/ui/inline_profile_editing",["module","require","exports","core/component","core/i18n","core/clock","app/utils/hide_or_show_divider","app/ui/with_scrollbar_width","app/utils/params","app/ui/tooltips","app/ui/with_inline_image_editing","app/utils/animate_window_scrolltop"],function(module, require, exports) {
function inlineProfileEditing(){this.defaultAttrs({cancelProfileButtonSelector:".cancel-profile-btn",saveProfileButtonSelector:".save-profile-btn",saveProfileFooterSelector:".save-profile-footer",bioProfileFieldSelector:".bio.profile-field",locationSelector:".location",urlProfileFieldSelector:".url .profile-field",dividerSelector:".location-and-url .divider",anchorSelector:"a",ignoreInTabIndex:".js-tooltip",tooltipSelector:".js-tooltip",updateSaveMessage:_('\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f'),scrollResetDuration:300,profileSavingClass:"profile-saving",profileEditingClass:"profile-editing",updateErrorMessage:_('\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u306e\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002'),useProfileErrorDialog:!0}),this.saveProfile=function(a,b){a.preventDefault(),this.trigger("uiEditProfileSaveFields"),this.trigger("uiEditProfileSave")},this.cancelProfileEditing=function(a,b){a.preventDefault();var c=$(a.target).attr("data-scribe-element");this.trigger("uiEditProfileCancel",{scribeContext:{element:c}}),this.trigger("uiEditProfileEnd")},this.isEditing=function(){return this.$body.hasClass(this.attr.profileEditingClass)},this.editModeOn=function(){animateWinScrollTop(0,this.attr.scrollResetDuration,function(){this.trigger(document,"uiProfileEditingOn")}.bind(this)),this.calculateScrollbarWidth(),this.$body.addClass(this.attr.profileEditingClass)},this.editModeOff=function(){this.$body.removeClass(this.attr.profileEditingClass),this.trigger(document,"uiProfileEditingOff")},this.fieldEditingModeOn=function(){this.$body.addClass("profile-field-editing"),this.select("dividerSelector").show()},this.fieldEditingModeOff=function(){this.$body.removeClass("profile-field-editing"),hideOrShowDivider(this.$node,this.attr.dividerSelector,this.attr.locationSelector,this.attr.urlProfileFieldSelector)},this.catchAnchorClicks=function(a){var b=$(a.target).attr("target")=="_blank";this.isEditing()&&!b&&a.preventDefault()},this.disabledTabbing=function(){this.select("ignoreInTabIndex").attr("tabindex","-1")},this.enableTabbing=function(){this.select("ignoreInTabIndex").removeAttr("tabindex")},this.saving=function(){this.$body.addClass(this.attr.profileSavingClass)},this.handleError=function(a,b){this.doneSaving(),this.fieldEditingModeOn();var c={message:b.message||this.attr.updateErrorMessage};this.trigger("uiShowProfileEditError",c),this.attr.useProfileErrorDialog||this.trigger("uiShowError",c)},this.savingError=function(a,b){clock.setTimeoutEvent("uiHandleSaveError",1e3,{message:b.message})},this.saveSuccess=function(a,b){this.doneSaving(),this.trigger("uiShowMessage",{message:this.attr.updateSaveMessage}),this.trigger("uiEditProfileSuccess")},this.doneSaving=function(){this.$body.removeClass(this.attr.profileSavingClass)},this.disableTooltips=function(){this.select("tooltipSelector").tooltip("disable").tooltip("hide")},this.enableTooltips=function(){this.select("tooltipSelector").tooltip("enable")},this.finishedProcessing=function(a,b){b&&b.linkified_description&&this.select("bioProfileFieldSelector").html(b.linkified_description),b&&b.user_url&&this.select("urlProfileFieldSelector").html(b.user_url),this.trigger("uiEditProfileEnd")},this.after("initialize",function(){this.$body=$("body"),this.on("click",{cancelProfileButtonSelector:this.cancelProfileEditing,saveProfileButtonSelector:this.saveProfile,anchorSelector:this.catchAnchorClicks}),this.on("uiEditProfileStart",this.editModeOn),this.on("uiEditProfileEnd",this.editModeOff),this.on("uiEditProfileStart",this.disableTooltips),this.on("uiEditProfileEnd",this.enableTooltips),this.on("uiEditProfileStart",this.fieldEditingModeOn),this.on("uiEditProfileSave",this.fieldEditingModeOff),this.on("uiEditProfileEnd",this.fieldEditingModeOff),this.on("uiEditProfileStart",this.disabledTabbing),this.on("uiEditProfileEnd",this.enableTabbing),this.on(document,"dataInlineEditSaveStarted",this.saving),this.on(document,"dataInlineEditSaveSuccess",this.saveSuccess),this.on(document,"dataInlineEditSaveError",this.savingError),this.on(document,"uiHandleSaveError",this.handleError),this.on(document,"dataInlineEditSaveSuccess",this.finishedProcessing)})}var defineComponent=require("core/component"),_=require("core/i18n"),clock=require("core/clock"),hideOrShowDivider=require("app/utils/hide_or_show_divider"),withScrollbarWidth=require("app/ui/with_scrollbar_width"),params=require("app/utils/params"),Tooltips=require("app/ui/tooltips"),withInlineImageEditing=require("app/ui/with_inline_image_editing"),animateWinScrollTop=require("app/utils/animate_window_scrolltop");module.exports=defineComponent(inlineProfileEditing,withScrollbarWidth,withInlineImageEditing)
});
define("app/data/settings",["module","require","exports","core/component","app/data/with_auth_token","app/data/with_data"],function(module, require, exports) {
var defineComponent = require('core/component'), withAuthToken = require('app/data/with_auth_token'), withData = require('app/data/with_data');
var SettingsData = defineComponent(settingsData, withData, withAuthToken);
function settingsData() {
    // TODO: dedupe these methods
    this.defaultAttrs({
        ajaxTimeout: 6000,
        noShowError: true
    });
    this.verifyUsername = function (event, data) {
        this.get({
            url: '/users/username_available',
            eventData: data,
            data: data,
            success: 'dataUsernameResult',
            error: 'dataUsernameError'
        });
    };
    this.verifyEmail = function (event, data) {
        this.get({
            url: '/users/email_available',
            eventData: data,
            data: data,
            success: 'dataEmailResult',
            error: 'dataEmailError'
        });
    };
    this.cancelPendingEmail = function (event, data) {
        var success = function (json) {
            this.trigger('dataCancelEmailSuccess', json);
        };
        var error = function (request) {
            this.trigger('dataCancelEmailFailure', request);
        };
        this.post({
            url: data.url,
            data: this.addAuthToken(),
            success: success.bind(this),
            error: error.bind(this)
        });
    };
    this.resendPendingEmail = function (event, data) {
        var success = function (json) {
            this.trigger('dataResendEmailSuccess', json);
        };
        var error = function (request) {
            this.trigger('dataResendEmailFailure', request);
        };
        this.post({
            url: data.url,
            data: this.addAuthToken(),
            success: success.bind(this),
            error: error.bind(this)
        });
    };
    this.resendPassword = function (event, data) {
        this.post({
            url: data.url,
            data: this.addAuthToken(),
            dataType: 'text',
            success: function () {
                this.trigger('dataForgotPasswordSuccess', {});
            }.bind(this)
        });
    };
    this.deleteGeoData = function (event) {
        var error = function (request) {
            this.trigger('dataGeoDeletionError', {});
        };
        this.post({
            url: '/account/delete_location_data',
            dataType: 'text',
            data: this.addAuthToken(),
            error: error.bind(this)
        });
    };
    this.revokeAuthority = function (event, data) {
        this.post({
            url: '/oauth/revoke',
            eventData: data,
            data: data,
            success: 'dataOAuthRevokeResultSuccess',
            error: 'dataOAuthRevokeResultFailure'
        });
    };
    // duckface events
    this.saveImage = function (event, data) {
        var uploadTypeToUrl = {
                header: '/settings/profile/upload_profile_header',
                avatar: '/settings/profile/profile_image_update'
            };
        data.page_context = this.attr.pageName;
        data.section_context = this.attr.sectionName;
        this.post({
            url: uploadTypeToUrl[data.uploadType],
            eventData: data,
            data: data,
            success: 'dataSaveImageSuccess',
            error: 'dataSaveImageFailure'
        });
    };
    this.deleteImage = function (event, data) {
        var uploadTypeToUrl = {
                header: '/settings/profile/destroy_profile_header',
                avatar: '/settings/profile/destroy_avatar'
            };
        data.page_context = this.attr.pageName;
        data.section_context = this.attr.sectionName;
        this.destroy({
            url: uploadTypeToUrl[data.uploadType],
            eventData: data,
            data: data,
            success: 'dataDeleteImageSuccess',
            error: 'dataDeleteImageFailure'
        });
    };
    // method also exists in data/email_banner.js
    this.resendConfirmationEmail = function (event, data) {
        this.post({
            url: '/account/resend_confirmation_email',
            eventData: data,
            data: data,
            success: 'dataResendConfirmationEmailSuccess',
            error: 'dataResendConfirmationEmailError'
        });
    };
    // Call to export tweets
    this.tweetExport = function (event, data) {
        this.post({
            url: '/account/request_tweet_export',
            eventData: data,
            data: data,
            success: 'dataTweetExportSuccess',
            error: 'dataTweetExportError'
        });
    };
    // Call to resend download email
    this.tweetExportResend = function (event, data) {
        this.post({
            url: '/account/request_tweet_export_resend',
            eventData: data,
            data: data,
            success: 'dataTweetExportResendSuccess',
            error: 'dataTweetExportResendError'
        });
    };
    // Call to increase rate limiter on user
    this.tweetExportIncrRateLimiter = function (event, data) {
        this.post({
            url: '/account/request_tweet_export_download',
            eventData: data,
            data: data,
            success: 'dataTweetExportDownloadSuccess',
            error: 'dataTweetExportDownloadError'
        });
    };
    this.after('initialize', function () {
        this.on('uiUsernameChange', this.verifyUsername);
        this.on('uiEmailChange', this.verifyEmail);
        this.on('uiCancelPendingEmail', this.cancelPendingEmail);
        this.on('uiResendPendingEmail', this.resendPendingEmail);
        this.on('uiForgotPassword', this.resendPassword);
        this.on('uiDeleteGeoData', this.deleteGeoData);
        this.on('uiRevokeClick', this.revokeAuthority);
        // duckface endpoint
        this.on('uiImageSave', this.saveImage);
        this.on('uiDeleteImage', this.deleteImage);
        // Grailbird (tweet / DM export)
        this.on('uiTweetExportButtonClicked', this.tweetExport);
        this.on('uiTweetExportResendButtonClicked', this.tweetExportResend);
        this.on('uiTweetExportConfirmEmail', this.resendConfirmationEmail);
        this.on('uiTweetExportIncrRateLimiter', this.tweetExportIncrRateLimiter);
        // signup uses these:
        this.on('dataValidateUsername', this.verifyUsername);
        this.on('dataValidateEmail', this.verifyEmail);
    });
}
module.exports = SettingsData;
});
define("app/ui/profile_edit_param",["module","require","exports","core/component","app/utils/params"],function(module, require, exports) {
function profileEditParam(){this.defaultAttrs({editHeaderParam:"edit_header",editParam:"edit"}),this.hasParam=function(a){return!!params.fromQuery(window.location)[a]},this.hasEditParam=function(){return this.hasParam(this.attr.editParam)},this.hasEditHeaderParam=function(){return this.hasParam(this.attr.editHeaderParam)},this.checkEditParam=function(){this.hasEditParam()?this.trigger("uiEditProfileInitialize",{scribeElement:"edit_param"}):this.hasEditHeaderParam()&&this.trigger("uiEditProfileInitializeAndFocusOnHeaderOptions",{scribeElement:"edit_header_param"})},this.after("initialize",function(){this.on(document,"uiSwiftLoaded uiPageChanged",this.checkEditParam)})}var defineComponent=require("core/component"),params=require("app/utils/params");module.exports=defineComponent(profileEditParam)
});
define("app/ui/edit_header_button",["module","require","exports","core/component","app/ui/with_verify_upload_type"],function(module, require, exports) {
function editHeaderButton(){this.defaultAttrs({scribeElement:"add_header_button",uploadType:"header"}),this.initializeAndEditHeader=function(a,b){this.trigger("uiEditProfileInitializeAndFocusOnHeaderOptions",{scribeElement:this.attr.scribeElement})},this.switchToHeaderPresentState=function(a,b){this.$node.addClass("has-header")},this.switchToHeaderAbsentState=function(a,b){this.$node.removeClass("has-header")},this.after("initialize",function(){this.on("click",this.initializeAndEditHeader),this.on(document,"dataDeleteImageSuccess",this.verifyUploadType(this.switchToHeaderAbsentState)),this.on(document,"dataSaveImageSuccess",this.verifyUploadType(this.switchToHeaderPresentState))})}var defineComponent=require("core/component"),withVerifyUploadType=require("app/ui/with_verify_upload_type");module.exports=defineComponent(editHeaderButton,withVerifyUploadType)
});
define("app/ui/alert_banner_to_message_drawer",["module","require","exports","core/component"],function(module, require, exports) {
function alertBannerToMessageDrawer(){this.showMessage=function(a,b){this.trigger("uiShowMessage",b)},this.after("initialize",function(){this.on("uiAlertBanner",this.showMessage)})}var defineComponent=require("core/component");module.exports=defineComponent(alertBannerToMessageDrawer)
});
define("app/boot/inline_edit",["module","require","exports","app/ui/inline_edit","app/data/async_profile","app/ui/dialogs/profile_image_upload_dialog","app/ui/dialogs/profile_edit_error_dialog","app/ui/dialogs/profile_confirm_image_delete_dialog","app/ui/droppable_image","app/data/inline_edit_scribe","app/data/settings/profile_image_upload_scribe","app/data/drag_and_drop_scribe","app/ui/settings/change_photo","app/ui/image_uploader","app/ui/inline_profile_editing_initializor","app/ui/inline_profile_editing","app/data/settings","app/utils/image","app/ui/profile_edit_param","app/ui/edit_header_button","app/ui/alert_banner_to_message_drawer","core/i18n"],function(module, require, exports) {
var InlineEdit=require("app/ui/inline_edit"),AsyncProfileData=require("app/data/async_profile"),ProfileImageUploadDialog=require("app/ui/dialogs/profile_image_upload_dialog"),ProfileEditErrorDialog=require("app/ui/dialogs/profile_edit_error_dialog"),ProfileConfirmImageDeleteDialog=require("app/ui/dialogs/profile_confirm_image_delete_dialog"),DroppableImage=require("app/ui/droppable_image"),InlineEditScribe=require("app/data/inline_edit_scribe"),ProfileImageUploadScribe=require("app/data/settings/profile_image_upload_scribe"),DragAndDropScribe=require("app/data/drag_and_drop_scribe"),ChangePhoto=require("app/ui/settings/change_photo"),ImageUploader=require("app/ui/image_uploader"),InlineProfileEditingInitializor=require("app/ui/inline_profile_editing_initializor"),InlineProfileEditing=require("app/ui/inline_profile_editing"),SettingsData=require("app/data/settings"),image=require("app/utils/image"),ProfileEditParam=require("app/ui/profile_edit_param"),EditHeaderButton=require("app/ui/edit_header_button"),AlertBannerToMessageDrawer=require("app/ui/alert_banner_to_message_drawer"),_=require("core/i18n");module.exports=function(b){InlineProfileEditingInitializor.attachTo(".profile-page-header",b);if(image.supportsCropper()){AlertBannerToMessageDrawer.attachTo(document),ProfileEditErrorDialog.attachTo("#profile_edit_error_dialog",{top:0,left:0}),InlineProfileEditing.attachTo(".profile-page-header",b),SettingsData.attachTo(document,b),AsyncProfileData.attachTo(document,b),InlineEdit.attachTo(".profile-page-header .editable-group"),InlineEditScribe.attachTo(document),ProfileImageUploadScribe.attachTo("#profile_image_upload_dialog"),ProfileImageUploadScribe.attachTo("#header_image_upload_dialog"),DragAndDropScribe.attachTo(document);var c={scribeContext:{component:"profile_image_upload"}};ProfileConfirmImageDeleteDialog.attachTo("#avatar_confirm_remove_dialog",{top:0,left:0,uploadType:"avatar"}),ImageUploader.attachTo(".avatar-settings .uploader-image .photo-selector",{maxSizeInBytes:10485760,fileTooBigMessage:_('10MB\u4ee5\u4e0b\u306e\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u753b\u50cf\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002'),uploadType:"avatar",eventData:c}),ProfileImageUploadDialog.attachTo("#profile_image_upload_dialog",{uploadType:"avatar",eventData:c,maximumWidth:b.maxAvatarUploadDimension,maximumHeight:b.maxAvatarUploadDimension}),ChangePhoto.attachTo("#choose-photo",{uploadType:"avatar",alwaysOpen:!0,confirmDelete:!0,eventData:c}),DroppableImage.attachTo(".profile-page-header .profile-picture",{uploadType:"avatar",eventData:c});var d={scribeContext:{component:"header_image_upload"}};ProfileConfirmImageDeleteDialog.attachTo("#header_confirm_remove_dialog",{top:0,left:0,uploadType:"header"}),ImageUploader.attachTo(".header-settings .uploader-image .photo-selector",{fileNameString:"user[profile_header_image_name]",fileDataString:"user[profile_header_image]",fileInputString:"user[profile_header_image]",uploadType:"header",maxSizeInBytes:1024e4,fileTooBigMessage:_('10MB\u3088\u308a\u5c0f\u3055\u3044\u753b\u50cf\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002'),onError:function(){window.scrollTo(0,0)},eventData:d}),ProfileImageUploadDialog.attachTo("#header_image_upload_dialog",{uploadType:"header",maskPadding:0,top:0,left:0,maximumWidth:1252,maximumHeight:626,imageNameSelector:"#choose-header div.photo-selector input.file-name",imageDataSelector:"#choose-header div.photo-selector input.file-data",eventData:d}),ChangePhoto.attachTo("#choose-header",{uploadType:"header",chooseExistingSelector:"#header-choose-existing",chooseWebcamSelector:"#header-choose-webcam",deleteImageSelector:"#header-delete-image",alwaysOpen:!0,confirmDelete:!0,eventData:d}),DroppableImage.attachTo(".profile-page-header .profile-header-inner",{uploadType:"header",eventData:d}),EditHeaderButton.attachTo(".enhanced-mini-profile-camera-button .edit-header-trigger")}ProfileEditParam.attachTo(".profile-page-header")}
});
define("app/ui/profile/canopy",["module","require","exports","core/component","core/utils"],function(module, require, exports) {
function profileCanopy(){this.defaultAttrs({verticalThreshold:280,retractedCanopyClass:"retracted"}),this.belowVerticalThreshhold=function(){return this.$window.scrollTop()>=this.attr.verticalThreshold},this.determineCanopyPresence=function(){var a=this.$node.hasClass(this.attr.retractedCanopyClass);this.belowVerticalThreshhold()?a&&this.trigger("uiShowProfileCanopy"):a||this.trigger("uiHideProfileCanopy")},this.showCanopyAfterModal=function(){this.belowVerticalThreshhold()&&this.showProfileCanopy()},this.hideCanopyBeforeModal=function(){this.belowVerticalThreshhold()&&this.hideProfileCanopy()},this.showProfileCanopy=function(){this.$node.removeClass(this.attr.retractedCanopyClass)},this.hideProfileCanopy=function(){this.$node.addClass(this.attr.retractedCanopyClass)},this.after("initialize",function(){this.$window=$(window),this.$node.removeClass("hidden"),this.on("uiShowProfileCanopy",this.showProfileCanopy),this.on("uiHideProfileCanopy",this.hideProfileCanopy),this.on(window,"scroll",utils.throttle(this.determineCanopyPresence.bind(this))),this.on(document,"uiShowProfilePopup",this.hideCanopyBeforeModal),this.on(document,"uiCloseProfilePopup",this.showCanopyAfterModal),this.determineCanopyPresence()})}var defineComponent=require("core/component"),utils=require("core/utils");module.exports=defineComponent(profileCanopy)
});
define("app/data/profile_canopy_scribe",["module","require","exports","core/component","core/utils","app/data/with_scribe"],function(module, require, exports) {
function profileCanopyScribe(){this.defaultAttrs({scribeContext:{component:"profile_canopy"}}),this.scribeProfileCanopy=function(a,b){var c=utils.merge(this.attr.scribeContext,{action:"impression"});this.scribe(c,b)},this.after("initialize",function(){this.on("uiShowProfileCanopy",this.scribeProfileCanopy)})}var defineComponent=require("core/component"),utils=require("core/utils"),withScribe=require("app/data/with_scribe"),ProfileCanopyScribe=defineComponent(profileCanopyScribe,withScribe);module.exports=ProfileCanopyScribe
});
define("app/ui/profile/head",["module","require","exports","core/component","core/i18n","app/ui/with_user_actions","app/ui/with_profile_stats","app/ui/with_handle_overflow","core/utils"],function(module, require, exports) {
function profileHead(){this.defaultAttrs({profileHead:!0,isCanopy:!1,editProfileButtonInlineSelector:".inline-edit-profile-btn",nonEmptyAvatarSelector:".profile-picture .avatar:not(.empty-avatar)",emptyAvatarSelector:".profile-picture .empty-avatar",overflowContainer:".profile-header-inner",itemType:"user",fullNameSelector:".fullname",usernameSelector:".username",urlSelector:".url a"}),this.showAvatarModal=function(a){a.preventDefault(),this.isEditing()||(this.trigger("uiAvatarClicked"),this.trigger(a.target,"uiOpenGallery",{title:_('@{{screenName}}\u3055\u3093\u306e\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb\u753b\u50cf',{screenName:this.attr.profile_user.screen_name})}))},this.emptyAvatarClicked=function(a){if(!this.isEditing()){a.preventDefault(),a.stopImmediatePropagation();var b=$(a.target).attr("data-scribe-element");$(document).one("uiEditProfileStart",this.showAvatarOptions.bind(this)),this.trigger("uiEditProfileInitialize",{scribeElement:b})}},this.showAvatarOptions=function(){this.trigger("uiShowEditAvatarOptions")},this.editProfileInline=function(a){a.preventDefault();var b=$(a.target).attr("data-scribe-element");this.trigger(document,"uiEditProfileInitialize",{scribeElement:b})},this.isEditing=function(){return $("body").hasClass("profile-editing")},this.fullNameClicked=function(){this.trigger("uiFullNameClicked")},this.usernameClicked=function(){this.trigger("uiUsernameClicked")},this.urlClicked=function(){this.trigger("uiUrlClicked")},this.notifyDropdownToHide=function(){this.trigger("uiCloseDropdowns")},this.after("initialize",function(){this.checkForOverflow(this.select("overflowContainer")),this.on("click",{nonEmptyAvatarSelector:this.showAvatarModal,emptyAvatarSelector:this.emptyAvatarClicked,editProfileButtonInlineSelector:this.editProfileInline,fullNameSelector:this.fullNameClicked,usernameSelector:this.usernameClicked,urlSelector:this.urlClicked}),this.attr.isCanopy&&this.on("uiHideProfileCanopy",this.notifyDropdownToHide),this.attr.eventData=utils.merge(this.attr.eventData||{},{scribeContext:this.attr.scribeContext,profileHead:this.attr.profileHead})})}var defineComponent=require("core/component"),_=require("core/i18n"),withUserActions=require("app/ui/with_user_actions"),withProfileStats=require("app/ui/with_profile_stats"),withHandleOverflow=require("app/ui/with_handle_overflow"),utils=require("core/utils");module.exports=defineComponent(profileHead,withUserActions,withProfileStats,withHandleOverflow)
});
define("app/data/profile_head_scribe",["module","require","exports","core/component","core/utils","app/data/with_scribe"],function(module, require, exports) {
function profileHeadScribe(){this.after("initialize",function(){this.scribeOnEvent("uiAvatarClicked",{element:"avatar",action:"click"}),this.scribeOnEvent("uiFullNameClicked",{element:"fullname",action:"click"}),this.scribeOnEvent("uiUsernameClicked",{element:"username",action:"click"}),this.scribeOnEvent("uiUrlClicked",{element:"url",action:"click"})})}var defineComponent=require("core/component"),utils=require("core/utils"),withScribe=require("app/data/with_scribe");module.exports=defineComponent(profileHeadScribe,withScribe)
});
define("app/ui/profile/social_proof",["module","require","exports","core/component","app/ui/with_item_actions"],function(module, require, exports) {
function profileSocialProof(){this.defaultAttrs({socialProofAvatarSelector:".social-proof .avatar",followersYouFollowSelector:".followers-you-follow",itemType:"user"}),this.socialProofAvatarClick=function(a,b){this.trigger("uiSocialProofAvatarClick")},this.viewAllFollowersYouFollow=function(a,b){this.trigger("uiFollowersYouFollowLink")},this.after("initialize",function(){this.trigger("uiHasProfileSocialProof"),this.on("click",{socialProofAvatarSelector:this.socialProofAvatarClick,followersYouFollowSelector:this.viewAllFollowersYouFollow})})}var defineComponent=require("core/component"),withItemActions=require("app/ui/with_item_actions"),ProfileSocialProof=defineComponent(profileSocialProof,withItemActions);module.exports=ProfileSocialProof
});
define("app/data/profile_social_proof_scribe",["module","require","exports","core/component","core/utils","app/data/with_scribe"],function(module, require, exports) {
function profileSocialProofScribe(){this.defaultAttrs({scribeContext:{component:"profile_follow_card"}}),this.scribeProfileSocialProof=function(a,b){var c=utils.merge(this.attr.scribeContext,{element:"social_proof",action:"impression"});this.scribe(c,b)},this.scribeSocialProofAvatarClick=function(a,b){var c=utils.merge(this.attr.scribeContext,{element:"social_proof_avatar",action:"click"});this.scribe(c,b)},this.scribeFollowersYouFolowClick=function(a,b){var c=utils.merge(this.attr.scribeContext,{element:"followers_you_follow",action:"click"});this.scribe(c,b)},this.after("initialize",function(){this.on("uiHasProfileSocialProof",this.scribeProfileSocialProof),this.on("uiSocialProofAvatarClick",this.scribeSocialProofAvatarClick),this.on("uiFollowersYouFollowLink",this.scribeFollowersYouFolowClick)})}var defineComponent=require("core/component"),utils=require("core/utils"),withScribe=require("app/data/with_scribe"),ProfileSocialProofScribe=defineComponent(profileSocialProofScribe,withScribe);module.exports=ProfileSocialProofScribe
});
define("app/ui/media/card_thumbnails",["module","require","exports","core/component","core/utils","app/utils/image_thumbnail","app/utils/image/image_loader","core/i18n"],function(module, require, exports) {
function cardThumbnails(){var a=800,b={NOT_LOADED:"not-loaded",LOADING:"loading",LOADED:"loaded"};this.hasMoreItems=!0,this.defaultAttrs({profileUser:!1,mediaGrid:!1,mediaGridOpen:!1,gridPushState:!1,pushStateUrl:"/",defaultGalleryTitle:_('\u30d5\u30a9\u30c8\u30ae\u30e3\u30e9\u30ea\u30fc'),viewAllSelector:".list-link",thumbnailSelector:".media-thumbnail",thumbnailContainerSelector:".photo-list",thumbnailPlaceholderSelector:".thumbnail-placeholder.first",thumbnailNotLoadedSelector:'.media-thumbnail[data-load-status="'+b.NOT_LOADED+'"]',thumbnailType:"thumb",thumbnailSize:90,thumbnailsVisible:6,showAllInlineMedia:!1,loadOnEventName:"uiLoadThumbnails",dataEvents:{requestItems:"uiWantsMoreMediaTimelineItems",gotItems:"dataGotMoreMediaTimelineItems"},defaultRequestData:{}}),this.thumbs=function(){return this.select("thumbnailSelector")},this.getMaxId=function(){var a=this.thumbs();if(a.length)return a.last().attr("data-status-id")},this.shouldGetMoreItems=function(a){var b=$(a.target);if(b.attr("data-paged"))return;this.getMoreItems()},this.getMoreItems=function(){if(!this.hasMoreItems)return;var a=this.thumbs();a.attr("data-paged",!0),this.trigger(document,this.attr.dataEvents.requestItems,utils.merge(this.attr.defaultRequestData,{max_id:this.getMaxId()}))},this.gotMoreItems=function(a,b){if(b.items_html&&$.trim(b.items_html).length){var c=$.isArray(b.items_html)?$(b.items_html.join("")):$(b.items_html);this.appendItems(c)}else this.hasMoreItems=!1;this.trigger(document,"dataGotMoreMediaItems",b),this.select("thumbnailSelector").length<this.attr.thumbnailsVisible&&this.hasMoreItems&&this.getMoreItems()},this.appendItems=function(a){this.attr.gridPushState&&(a.addClass("js-nav"),a.attr("href",this.attr.pushStateUrl)),this.select("thumbnailPlaceholderSelector").before(a),this.removeUnsupportedTypes(),this.renderVisible()},this.removeUnsupportedTypes=function(){this.select("thumbnailSelector").each(function(a,b){$(b).attr("data-card-type")==="summary"&&$(b).remove()})},this.renderVisible=function(){var a=this.select("thumbnailSelector").slice(0,this.attr.thumbnailsVisible),b=a.filter(this.attr.thumbnailNotLoadedSelector);if(b.length){this.loadThumbs(b);var c={thumbnails:[]};b.each(function(a,b){c.thumbnails.push($(b).attr("data-url"))}),this.trigger("uiMediaThumbnailsVisible",c)}else a.length>0&&this.showThumbs();var c={thumbnails:[]};b.each(function(a,b){c.thumbnails.push($(b).attr("data-url"))}),this.trigger("uiMediaThumbnailsVisible",c)},this.loadThumbs=function(a){a.attr("data-load-status",b.LOADING),a.each(this.loadThumb.bind(this))},this.loadThumb=function(a,b){var c=$(b),d=function(a){this.loadThumbSuccess(c,a)}.bind(this),e=function(){this.loadThumbFail(c)}.bind(this);imageLoader.load(c.attr("data-resolved-url-"+this.attr.thumbnailType),d,e)},this.loadThumbSuccess=function(a,c){a.attr("data-load-status",b.LOADED),c.css(imageThumbnail.getThumbnailOffset(c.get(0).height,c.get(0).width,this.attr.thumbnailSize)),a.append(c),this.showThumbs()},this.loadThumbFail=function(a){a.remove(),this.renderVisible()},this.showThumbs=function(){this.$node.show(),this.$node.attr("data-loaded",!0),this.gridAutoOpen()},this.thumbnailClick=function(a){a.stopPropagation(),a.preventDefault(),this.openGallery(a.target);var b=$(a.target),c=b.hasClass("video")?"video":"photo";this.trigger("uiMediaThumbnailClick",{url:b.attr("data-url"),mediaType:c})},this.gridAutoOpen=function(){this.attr.mediaGrid&&this.attr.mediaGridOpen&&this.thumbs().length&&this.viewGrid()},this.viewAllClick=function(a){this.attr.mediaGrid?this.trigger("uiMediaViewAllClick"):(this.openGallery(this.thumbs()[0]),a.preventDefault())},this.showThumbs=function(){this.$node.show(),this.$node.attr("data-loaded",!0),this.attr.mediaGridOpen&&(this.attr.mediaGridOpen=!1,this.viewGrid())},this.viewGrid=function(){this.openGrid(this.thumbs()[0])},this.openGrid=function(a){this.trigger(a,"uiOpenGrid",{gridTitle:this.attr.defaultGalleryTitle,profileUser:this.attr.profileUser})},this.openGallery=function(a){this.trigger(a,"uiOpenGallery",{gridTitle:this.attr.defaultGalleryTitle,showGrid:this.attr.mediaGrid,profileUser:this.attr.profileUser})},this.removeThumbs=function(){this.thumbs().remove()},this.before("teardown",this.removeThumbs),this.after("initialize",function(){this.$node.attr("data-loaded")||(this.$node.hide(),this.trigger("uiMediaThumbnailsVisible",{thumbnails:[]}),this.thumbs().length>0&&this.renderVisible()),this.on("click",{thumbnailSelector:this.thumbnailClick,viewAllSelector:this.viewAllClick}),this.gridAutoOpen(),this.on(document,this.attr.dataEvents.gotItems,this.gotMoreItems),this.on("uiGalleryMediaLoad",this.shouldGetMoreItems),this.attr.showAllInlineMedia?this.getMoreItems():this.on(document,"uiReloadThumbs",this.getMoreItems)})}var defineComponent=require("core/component"),utils=require("core/utils"),imageThumbnail=require("app/utils/image_thumbnail"),imageLoader=require("app/utils/image/image_loader"),_=require("core/i18n"),CardThumbnails=defineComponent(cardThumbnails);module.exports=CardThumbnails
});
define("app/data/media_timeline",["module","require","exports","core/component","app/data/with_data"],function(module, require, exports) {
function mediaTimeline(){this.requestItems=function(a,b){var c={},d={since_id:b.since_id,max_id:b.max_id};this.attr.forceT1Media&&(d.force_t1_media=!0),this.get({url:this.attr.endpoint,headers:c,data:d,eventData:b,success:"dataGotMoreMediaTimelineItems",error:"dataGotMoreMediaTimelineItemsError"})},this.after("initialize",function(){this.on(document,"uiWantsMoreMediaTimelineItems",this.requestItems)})}var defineComponent=require("core/component"),withData=require("app/data/with_data");module.exports=defineComponent(mediaTimeline,withData)
});
define("app/ui/suggested_users",["module","require","exports","core/component","app/ui/with_user_actions","app/ui/with_item_actions","app/ui/with_interaction_data"],function(module, require, exports) {
function suggestedUsers(){this.defaultAttrs({closeSelector:".js-close",itemType:"user",userSelector:".js-actionable-user",targetSelector:"#suggested-users",childSelector:"",followedButtonSelector:".stream-item .following",lastStreamItemSelector:".stream-end-item",streamItemSelector:".stream-item",streamItemsSelector:"#suggested-users .stream-item",refreshAnimationDuration:200,isClusterFollowReplenishEnabled:!1}),this.getTimelineNodeSelector=function(a){return this.attr.targetSelector+(a?'[data-item-id="'+a+'"]':"")+" "+this.attr.childSelector},this.getPosition=function(a){var b=$(this.attr.streamItemsSelector);return b.index(a.closest(this.attr.streamItemSelector))+1},this.replaceSuggestedUser=function(a,b){var c=$(this.attr.targetSelector).find(this.attr.followedButtonSelector).closest(this.attr.userSelector);if(c.length===0)return;var d=this.getPosition(c),e=$(b.html).find(this.attr.userSelector),f=this.attr.refreshAnimationDuration;c.fadeOut(f,function(){c.replaceWith(e.hide()),e.fadeIn(f)});var g=[this.interactionData(e,{position:d})],h=[{id:e.attr("data-user-id"),impressionId:e.attr("data-impression-id")}];this.trigger("uiSuggestedUsersRendered",{isReplacement:!0,items:g,user_id:b.sourceEventData.userId}),this.trigger("uiUsersDisplayed",{users:h})},this.slideInUsersList=function(a,b){if(this.$node.hasClass("has-content"))return;this.$node.addClass("has-content"),this.$node.html(b.html);var c=this.$node.outerHeight(),d=$(window).scrollTop();d>this.$node.position().top+c?$(window).scrollTop(d+c):this.$node.hide().slideDown();var e=this.$node.find(this.attr.userSelector),f=e.map(function(a,b){return this.interactionData($(b),{position:a})}.bind(this)).get(),g=e.map(function(a,b){var c=$(b);return{id:c.attr("data-user-id"),impressionId:c.attr("data-impression-id")}}).get();this.trigger("uiSuggestedUsersRendered",{items:f,user_id:b.sourceEventData.userId}),this.trigger("uiUsersDisplayed",{users:g})},this.isClusterFollowAction=function(a){return a.closest(this.attr.targetSelector).length>0},this.handleClusterFollow=function(a,b){this.isClusterFollowAction($(a.target))&&this.attr.isClusterFollowReplenishEnabled&&this.trigger("uiGetClusterFollowReplacementSuggestion",{isReplacement:!0})},this.handleSuggestedUsersResults=function(a,b){b.isReplacement?this.replaceSuggestedUser(a,b):this.slideInUsersList(a,b)},this.slideOutContent=function(a,b){this.$node.slideUp(function(){this.$node.empty().show(),this.$node.removeClass("has-content")}.bind(this))},this.after("initialize",function(){this.on(document,"dataSuggestedUsersSuccess",this.handleSuggestedUsersResults),this.on(document,"uiFollowAction",this.handleClusterFollow),this.on("click",{closeSelector:this.slideOutContent})})}var defineComponent=require("core/component"),withUserActions=require("app/ui/with_user_actions"),withItemActions=require("app/ui/with_item_actions"),withInteractionData=require("app/ui/with_interaction_data");module.exports=defineComponent(suggestedUsers,withUserActions,withItemActions,withInteractionData)
});
define("app/data/suggested_users",["module","require","exports","core/component","app/data/with_data","core/utils","app/data/with_interaction_data_scribe"],function(module, require, exports) {
function suggestedUsersData(){this.shouldPerformRequest=function(a){return a&&(a.profileHead||a.isReplacement)},this.getLimit=function(a){return a.isReplacement?1:3},this.getHTML=function(a,b){function c(a){a.html&&(a.isReplacement=b.isReplacement,this.trigger("dataSuggestedUsersSuccess",a))}if(!this.shouldPerformRequest(b))return;this.get({url:"/i/users/suggested_users",data:{user_id:b.userId,pc:!0,limit:this.getLimit(b),display_location:"cluster-follow"},eventData:b,success:c.bind(this),error:"dataSuggestedUsersFailure"})},this.scribeSuggestedUserResults=function(a,b){var c=b.isReplacement?"newer":"initial";this.scribeInteractiveResults({element:c,action:"results"},b.items,b,{referring_event:c,profile_id:b.user_id})},this.after("initialize",function(a,b){this.on("uiSuggestedUsersRendered",this.scribeSuggestedUserResults),this.on("uiFollowAction uiGetClusterFollowReplacementSuggestion",this.getHTML)})}var defineComponent=require("core/component"),withData=require("app/data/with_data"),utils=require("core/utils"),withInteractionDataScribe=require("app/data/with_interaction_data_scribe");module.exports=defineComponent(suggestedUsersData,withData,withInteractionDataScribe)
});
define("app/ui/profile/alcohol_brand_follower_notification",["module","require","exports","core/component"],function(module, require, exports) {
function alcoholBrandFollowerNotification(){this.after("initialize",function(){var a=this.attr.profile_user_follows_alcohol_brand;a&&this.$node.trigger("uiShowStickyMessage",{message:a})})}var defineComponent=require("core/component"),AlcoholBrandFollowerNotification=defineComponent(alcoholBrandFollowerNotification);module.exports=AlcoholBrandFollowerNotification
});
define("app/ui/profile/auto_signup_dialog",["module","require","exports","core/component","app/utils/storage/with_expiry"],function(module, require, exports) {
function autoSignupDialog(){this.namespace="signup_dialog",this.storageKey="until",this.possiblyShowDialog=function(){this.isExpired(this.storageKey)&&(this.showDialog(),this.clear(),this.updateComponentTTL())},this.showDialog=function(){this.trigger("uiOpenSigninOrSignupDialog")},this.updateComponentTTL=function(){var a=1e4,b=864e5;this.attr.environment=="selenium"?this.updateTTL(this.storageKey,a):this.updateTTL(this.storageKey,b)},this.after("initialize",function(){this.on(document,"uiSwiftLoaded uiPageChanged",this.possiblyShowDialog)})}var defineComponent=require("core/component"),withExpiry=require("app/utils/storage/with_expiry");module.exports=defineComponent(autoSignupDialog,withExpiry)
});
define("app/boot/profile",["module","require","exports","app/boot/app","core/i18n","app/data/profile_info","app/boot/trends","app/boot/logged_out","app/boot/inline_edit","app/ui/profile/canopy","app/data/profile_canopy_scribe","app/ui/profile/head","app/data/profile_head_scribe","app/ui/profile/social_proof","app/data/profile_social_proof_scribe","app/ui/dashboard_tweetbox","app/ui/who_to_follow/who_to_follow_dashboard","app/data/who_to_follow/wtf_import_prompt_scribe","app/ui/who_to_follow/import_services","app/data/who_to_follow","app/data/who_to_follow_scribe","app/ui/profile/recent_connections_module","app/ui/media/card_thumbnails","app/data/media_timeline","app/data/media_thumbnails_scribe","core/utils","app/ui/suggested_users","app/data/suggested_users","app/data/client_event","app/ui/navigation_links","app/data/profile_edit_btn_scribe","app/boot/wtf_module","app/ui/dm_envelope","app/ui/profile/alcohol_brand_follower_notification","app/ui/profile/profile_preview_banner","app/data/profile_preview_banner_scribe","app/ui/profile/auto_signup_dialog"],function(module, require, exports) {
function initialize(a){bootApp(a),profileInfo.set(a),trends(a),whoToFollowModule(".dashboard .js-wtf-module",a);var b=".profile-canopy",c={scribeContext:{component:"profile_canopy"}};ProfileHead.attachTo(b,a,c,{profileHead:!1,isCanopy:!0}),ProfileHeadScribe.attachTo(b,c),ProfileCanopy.attachTo(b),ProfileCanopyScribe.attachTo(b);var d=".profile-page-header",e={scribeContext:{component:"profile_follow_card"}};ProfileHead.attachTo(d,a,e),ProfileHeadScribe.attachTo(d),ProfilePreviewBanner.attachTo(".ProfilePreviewBanner"),ProfilePreviewBannerScribe.attachTo(document),DMEnvelope.attachTo(d,{noTeardown:!0,directMessagesSelector:".dm-button"});var f=".profile-social-proof";ProfileSocialProofScribe.attachTo(f),ProfileSocialProof.attachTo(f,{profileHoversEnabled:a.profileHoversEnabled}),a.inlineProfileEditing&&inlineEditBoot(a),ProfileEditBtnScribe.attachTo(d,e),clientEvent.scribeData.profile_id=a.profile_id,loggedOutBoot(a),MediaThumbnailsScribe.attachTo(document,a);var g={showAllInlineMedia:!0,defaultGalleryTitle:a.profile_user.name,profileUser:a.profile_user,mediaGrid:a.mediaGrid,mediaGridOpen:a.mediaGridOpen,gridPushState:a.mediaGrid,pushStateUrl:"/"+a.profile_user.screen_name+"/media",eventData:{scribeContext:{component:"dashboard_media"}}},h;h=".enhanced-media-thumbnails",g.thumbnailSize=90,g.thumbnailsVisible=6,MediaTimeline.attachTo(document,{endpoint:"/i/profiles/show/"+a.profile_user.screen_name+"/media_timeline",forceT1Media:a.force_t1_media}),CardThumbnails.attachTo(h,utils.merge(a,g)),NavigationLinks.attachTo(".profile-page-header",{eventData:{scribeContext:{component:"profile_follow_card"}}}),NavigationLinks.attachTo(".view-toggler",{eventData:{scribeContext:{component:"dashboard_nav"}}}),DashboardTweetbox.attachTo(".profile-tweet-box",{draftTweetId:"profile_"+a.profile_id,eventData:{scribeContext:{component:"tweet_box"}}});var i=utils.merge(a,{eventData:{scribeContext:{component:"similar_user_recommendations"}}}),j=".dashboard .js-similar-to-module";WTFImportPromptScribe.attachTo(j,i),WhoToFollowDashboard.attachTo(j,i),WhoToFollowData.attachTo(j,i),WhoToFollowScribe.attachTo(j,i),ImportServices.attachTo(".dashboard .import-prompt",a,{otherServicesSelector:".other-services",eventData:{scribeContext:{component:"user_recommendations",element:"wtf_import_prompt"}}}),RecentConnectionsModule.attachTo(".dashboard .recent-followers-module",a,{eventData:{scribeContext:{component:"recent_followers"}}}),RecentConnectionsModule.attachTo(".dashboard .recently-followed-module",a,{eventData:{scribeContext:{component:"recently_followed"}}}),SuggestedUsersData.attachTo(document,a),SuggestedUsers.attachTo("#suggested-users",utils.merge({eventData:{scribeContext:{component:"user_similarities_list"}}},a)),AlcoholBrandFollowerNotification.attachTo(document,a),AutoSignupDialog.attachTo(".SignupDialog",{environment:a.environment})}var bootApp=require("app/boot/app"),_=require("core/i18n"),profileInfo=require("app/data/profile_info"),trends=require("app/boot/trends"),loggedOutBoot=require("app/boot/logged_out"),inlineEditBoot=require("app/boot/inline_edit"),ProfileCanopy=require("app/ui/profile/canopy"),ProfileCanopyScribe=require("app/data/profile_canopy_scribe"),ProfileHead=require("app/ui/profile/head"),ProfileHeadScribe=require("app/data/profile_head_scribe"),ProfileSocialProof=require("app/ui/profile/social_proof"),ProfileSocialProofScribe=require("app/data/profile_social_proof_scribe"),DashboardTweetbox=require("app/ui/dashboard_tweetbox"),WhoToFollowDashboard=require("app/ui/who_to_follow/who_to_follow_dashboard"),WTFImportPromptScribe=require("app/data/who_to_follow/wtf_import_prompt_scribe"),ImportServices=require("app/ui/who_to_follow/import_services"),WhoToFollowData=require("app/data/who_to_follow"),WhoToFollowScribe=require("app/data/who_to_follow_scribe"),RecentConnectionsModule=require("app/ui/profile/recent_connections_module"),CardThumbnails=require("app/ui/media/card_thumbnails"),MediaTimeline=require("app/data/media_timeline"),MediaThumbnailsScribe=require("app/data/media_thumbnails_scribe"),utils=require("core/utils"),SuggestedUsers=require("app/ui/suggested_users"),SuggestedUsersData=require("app/data/suggested_users"),clientEvent=require("app/data/client_event"),NavigationLinks=require("app/ui/navigation_links"),ProfileEditBtnScribe=require("app/data/profile_edit_btn_scribe"),whoToFollowModule=require("app/boot/wtf_module"),DMEnvelope=require("app/ui/dm_envelope"),AlcoholBrandFollowerNotification=require("app/ui/profile/alcohol_brand_follower_notification"),ProfilePreviewBanner=require("app/ui/profile/profile_preview_banner"),ProfilePreviewBannerScribe=require("app/data/profile_preview_banner_scribe"),AutoSignupDialog=require("app/ui/profile/auto_signup_dialog");module.exports=initialize
});
define("app/pages/profile/tweets",["module","require","exports","app/boot/profile","app/boot/tweet_timeline","app/boot/user_completion_module","app/data/contact_import","app/data/contact_import_scribe","app/ui/who_to_follow/import_loading_dialog","app/ui/who_to_follow/import_services"],function(module, require, exports) {
var profileBoot=require("app/boot/profile"),tweetTimelineBoot=require("app/boot/tweet_timeline"),userCompletionModuleBoot=require("app/boot/user_completion_module"),ContactImportData=require("app/data/contact_import"),ContactImportScribe=require("app/data/contact_import_scribe"),ImportLoadingDialog=require("app/ui/who_to_follow/import_loading_dialog"),ImportServices=require("app/ui/who_to_follow/import_services");module.exports=function(b){profileBoot(b),tweetTimelineBoot(b,b.timeline_url,"tweet"),userCompletionModuleBoot(b),ContactImportData.attachTo(document,b),ContactImportScribe.attachTo(document,b),ImportLoadingDialog.attachTo("#import-loading-dialog",b),ImportServices.attachTo(".dashboard .import-prompt",b,{otherServicesSelector:".other-services",eventData:{scribeContext:{component:"user_recommendations",element:"wtf_import_prompt"}}}),b.profile_user&&$(document).trigger("profileVisit",b.profile_user)}
});
define("app/ui/timelines/with_cursor_pagination",["module","require","exports"],function(module, require, exports) {
function withCursorPagination(){function a(){return!0}function b(){return!1}this.isOldItem=a,this.isNewItem=b,this.wasRangeRequest=b,this.wasNewItemsRequest=b,this.wasOldItemsRequest=a,this.shouldGetOldItems=function(){return!!this.cursor&&this.cursor!="0"},this.getOldItemsData=function(){return{cursor:this.cursor,cursor_index:this.cursorIndex,cursor_offset:this.cursorOffset,is_forward:!this.attr.isBackward,query:this.query}},this.resetStateVariables=function(a){a&&a.cursor!==undefined?(this.cursor=a.cursor,this.select("containerSelector").attr("data-cursor",this.cursor)):this.cursor=this.select("containerSelector").attr("data-cursor")||"",a&&a.cursor_index!==undefined?(this.cursorIndex=a.cursor_index,this.select("containerSelector").attr("data-cursor-index",this.cursorIndex)):this.cursorIndex=this.select("containerSelector").attr("data-cursor-index")||"",a&&a.cursor_offset!==undefined?(this.cursorOffset=a.cursor_offset,this.select("containerSelector").attr("data-cursor-offset",this.cursorOffset)):this.cursorOffset=this.select("containerSelector").attr("data-cursor-offset")||""},this.after("initialize",function(){this.query=this.attr.query||"",this.resetStateVariables(),this.on("uiTimelineReset",this.resetStateVariables)})}module.exports=withCursorPagination
});
define("app/ui/with_stream_users",["module","require","exports"],function(module, require, exports) {
function withStreamUsers(){this.defaultAttrs({streamUserSelector:".stream-items .js-actionable-user"}),this.oldUsersDisplayed=function(a,b){var c=b.items||[],d=c.map(function(a){return{id:a.userId,impressionId:a.impressionId}});this.trigger("uiUsersDisplayed",{users:d})},this.usersDisplayed=function(){var a=this.select("streamUserSelector"),b=[];a.each(function(a,c){var d=$(c);b.push({id:d.attr("data-user-id"),impressionId:d.attr("data-impression-id")})}),this.trigger("uiUsersDisplayed",{users:b})},this.after("initialize",function(){this.usersDisplayed(),this.on("uiHasInjectedOldTimelineItems",this.oldUsersDisplayed)})}module.exports=withStreamUsers
});
define("app/ui/timelines/with_excluded_ids_pagination",["module","require","exports"],function(module, require, exports) {
function withExcludedIdsPagination(){this.aroundGetOldItemsData=function(a){var b=a();return this.attr.useExcludedIdsPagination&&(b.excluded=this.select("excludedUserSelector").map(function(){return $(this).attr("data-user-id")}).toArray().join(","),b.cursor=undefined),b},this.after("initialize",function(){this.around("getOldItemsData",this.aroundGetOldItemsData)})}module.exports=withExcludedIdsPagination
});
define("app/ui/timelines/user_timeline",["module","require","exports","core/component","app/ui/timelines/base_timeline","app/ui/timelines/with_old_items","app/ui/timelines/with_cursor_pagination","app/ui/with_item_actions","app/ui/with_user_actions","app/ui/with_stream_users","app/ui/timelines/with_excluded_ids_pagination"],function(module, require, exports) {
function userTimeline(){this.defaultAttrs({itemType:"user"})}var defineComponent=require("core/component"),BaseTimeline=require("app/ui/timelines/base_timeline"),withOldItems=require("app/ui/timelines/with_old_items"),withCursorPagination=require("app/ui/timelines/with_cursor_pagination"),withItemActions=require("app/ui/with_item_actions"),withUserActions=require("app/ui/with_user_actions"),withStreamUsers=require("app/ui/with_stream_users"),withExcludedIdsPagination=require("app/ui/timelines/with_excluded_ids_pagination");module.exports=BaseTimeline.mixin(userTimeline,withOldItems,withCursorPagination,withItemActions,withUserActions,withStreamUsers,withExcludedIdsPagination)
});
define("app/boot/user_timeline",["module","require","exports","app/boot/timeline","app/ui/timelines/user_timeline","app/data/tweet_actions","core/utils"],function(module, require, exports) {
function initialize(a,b,c,d){var e=utils.merge(a,{endpoint:b,itemType:c,eventData:{scribeContext:{component:d}}});timelineBoot(e),UserTimeline.attachTo("#timeline",e),TweetActionsData.attachTo(document,e)}var timelineBoot=require("app/boot/timeline"),UserTimeline=require("app/ui/timelines/user_timeline"),TweetActionsData=require("app/data/tweet_actions"),utils=require("core/utils");module.exports=initialize
});
define("app/ui/timelines/follower_request_timeline",["module","require","exports","core/component","app/ui/with_interaction_data"],function(module, require, exports) {
function followerRequestTimeline(){this.defaultAttrs({userItemSelector:"div.js-follower-request",streamUserItemSelector:"li.js-stream-item",followerActionsSelector:".friend-actions",profileActionsSelector:".js-profile-actions",acceptFollowerSelector:".js-action-accept",declineFollowerSelector:".js-action-deny",itemType:"user"}),this.findUser=function(a){return this.$node.find(this.attr.userItemSelector+"[data-user-id="+a+"]")},this.findFollowerActions=function(a){return this.findUser(a).find(this.attr.followerActionsSelector)},this.findProfileActions=function(a){return this.findUser(a).find(this.attr.profileActionsSelector)},this.handleAcceptSuccess=function(a,b){var c=this.findFollowerActions(b.userId),d=this.findProfileActions(b.userId);c.fadeOut(300,function(){d.fadeIn(300)})},this.handleDeclineSuccess=function(a,b){var c=this.findUser(b.userId);c.closest(this.attr.streamUserItemSelector).remove()},this.handleDecisionFailure=function(a,b){var c=this.findFollowerActions(b.userId);c.find(".btn").attr("disabled",!1).removeClass("pending")},this.handleFollowerDecision=function(a){return function(b,c){b.preventDefault(),b.stopPropagation();var d=this.interactionData(b),e=this.findFollowerActions(d.userId);e.find(".btn").attr("disabled",!0);var f=e.find(a=="Accept"?this.attr.acceptFollowerSelector:this.attr.declineFollowerSelector);f.addClass("pending"),this.trigger("uiDidFollower"+a,d)}},this.after("initialize",function(){this.on("click",{acceptFollowerSelector:this.handleFollowerDecision("Accept"),declineFollowerSelector:this.handleFollowerDecision("Decline")}),this.on(document,"dataFollowerAcceptSuccess",this.handleAcceptSuccess),this.on(document,"dataFollowerDeclineSuccess",this.handleDeclineSuccess),this.on(document,"dataFollowerAcceptFailure dataFollowerDeclineFailure",this.handleDecisionFailure)})}var defineComponent=require("core/component"),withInteractionData=require("app/ui/with_interaction_data");module.exports=defineComponent(followerRequestTimeline,withInteractionData)
});
define("app/data/follower_request",["module","require","exports","core/component","app/data/with_data"],function(module, require, exports) {
function followerRequestData(){this.followerRequestAction=function(a,b){return function(c,d){var e=function(a){this.trigger("dataFollower"+b+"Success",{userId:d.userId,pendingRequestsHtml:a.pendingRequestsHtml})}.bind(this),f=function(){this.trigger("dataFollower"+b+"Failure",{userId:d.userId})}.bind(this);this.post({url:a,data:{user_id:d.userId},eventData:d,success:e,error:f})}},this.after("initialize",function(){this.on(document,"uiDidFollowerAccept",this.followerRequestAction("/i/user/accept","Accept")),this.on(document,"uiDidFollowerDecline",this.followerRequestAction("/i/user/deny","Decline"))})}var defineComponent=require("core/component"),withData=require("app/data/with_data");module.exports=defineComponent(followerRequestData,withData)
});
define("app/data/follower_request_scribe",["module","require","exports","core/component","app/data/with_scribe"],function(module, require, exports) {
function followerRequestScribe(){this.after("initialize",function(){this.scribeOnEvent("dataFollowerAcceptSuccess",{component:"user",action:"accept"}),this.scribeOnEvent("dataFollowerDeclineSuccess",{component:"user",action:"decline"})})}var defineComponent=require("core/component"),withScribe=require("app/data/with_scribe");module.exports=defineComponent(withScribe,followerRequestScribe)
});
define("app/pages/profile/follower_requests",["module","require","exports","app/boot/profile","app/boot/user_timeline","app/ui/timelines/follower_request_timeline","app/data/follower_request","app/data/follower_request_scribe"],function(module, require, exports) {
var profileBoot=require("app/boot/profile"),userTimelineBoot=require("app/boot/user_timeline"),FollowerRequestTimeline=require("app/ui/timelines/follower_request_timeline"),FollowerRequestData=require("app/data/follower_request"),FollowerRequestScribe=require("app/data/follower_request_scribe");module.exports=function(b){profileBoot(b),userTimelineBoot(b,b.timeline_url,"user"),FollowerRequestTimeline.attachTo("#timeline",b),FollowerRequestData.attachTo(document,b),FollowerRequestScribe.attachTo(document)}
});
define("app/pages/profile/followers",["module","require","exports","app/boot/profile","app/boot/user_timeline","app/data/contact_import","app/data/contact_import_scribe","app/ui/who_to_follow/import_loading_dialog","app/ui/who_to_follow/import_services"],function(module, require, exports) {
var profileBoot=require("app/boot/profile"),userTimelineBoot=require("app/boot/user_timeline"),ContactImportData=require("app/data/contact_import"),ContactImportScribe=require("app/data/contact_import_scribe"),ImportLoadingDialog=require("app/ui/who_to_follow/import_loading_dialog"),ImportServices=require("app/ui/who_to_follow/import_services");module.exports=function(b){profileBoot(b),userTimelineBoot(b,b.timeline_url,"user","user"),ContactImportData.attachTo(document,b),ContactImportScribe.attachTo(document,b),ImportLoadingDialog.attachTo("#import-loading-dialog",b),ImportServices.attachTo(".content-main.import-prompt",b,{eventData:{scribeContext:{component:"address_book_import_prompt"}}})}
});
define("app/pages/profile/following",["module","require","exports","app/boot/profile","app/boot/user_timeline","app/ui/suggested_users","app/data/contact_import","app/data/contact_import_scribe","app/ui/who_to_follow/import_loading_dialog","app/ui/who_to_follow/import_services"],function(module, require, exports) {
var profileBoot=require("app/boot/profile"),userTimelineBoot=require("app/boot/user_timeline"),SuggestedUsers=require("app/ui/suggested_users"),ContactImportData=require("app/data/contact_import"),ContactImportScribe=require("app/data/contact_import_scribe"),ImportLoadingDialog=require("app/ui/who_to_follow/import_loading_dialog"),ImportServices=require("app/ui/who_to_follow/import_services");module.exports=function(b){profileBoot(b),userTimelineBoot(b,b.timeline_url,"user","user"),ContactImportData.attachTo(document,b),ContactImportScribe.attachTo(document,b),ImportLoadingDialog.attachTo("#import-loading-dialog",b),ImportServices.attachTo(".content-main.import-prompt",b,{eventData:{scribeContext:{component:"address_book_import_prompt"}}})}
});
define("app/pages/profile/favorites",["module","require","exports","app/boot/profile","app/boot/tweet_timeline","app/data/contact_import","app/data/contact_import_scribe","app/ui/who_to_follow/import_loading_dialog","app/ui/who_to_follow/import_services"],function(module, require, exports) {
var profileBoot=require("app/boot/profile"),tweetTimelineBoot=require("app/boot/tweet_timeline"),ContactImportData=require("app/data/contact_import"),ContactImportScribe=require("app/data/contact_import_scribe"),ImportLoadingDialog=require("app/ui/who_to_follow/import_loading_dialog"),ImportServices=require("app/ui/who_to_follow/import_services");module.exports=function(b){profileBoot(b),tweetTimelineBoot(b,b.timeline_url,"tweet"),ContactImportData.attachTo(document,b),ContactImportScribe.attachTo(document,b),ImportLoadingDialog.attachTo("#import-loading-dialog",b),ImportServices.attachTo(".dashboard .import-prompt",b,{otherServicesSelector:".other-services",eventData:{scribeContext:{component:"user_recommendations",element:"wtf_import_prompt"}}})}
});
define("app/ui/timelines/list_timeline",["module","require","exports","core/component","app/ui/timelines/base_timeline","app/ui/timelines/with_old_items","app/ui/timelines/with_cursor_pagination","app/ui/with_item_actions","app/ui/with_user_actions"],function(module, require, exports) {
function listTimeline(){this.defaultAttrs({itemType:"list"})}var defineComponent=require("core/component"),BaseTimeline=require("app/ui/timelines/base_timeline"),withOldItems=require("app/ui/timelines/with_old_items"),withCursorPagination=require("app/ui/timelines/with_cursor_pagination"),withItemActions=require("app/ui/with_item_actions"),withUserActions=require("app/ui/with_user_actions");module.exports=BaseTimeline.mixin(listTimeline,withOldItems,withCursorPagination,withItemActions,withUserActions)
});
define("app/boot/list_timeline",["module","require","exports","app/boot/timeline","app/ui/timelines/list_timeline","app/data/tweet_actions","core/utils"],function(module, require, exports) {
function initialize(a,b,c,d){var e=utils.merge(a,{endpoint:b,itemType:c,eventData:{scribeContext:{component:d||c}}});timelineBoot(e),ListTimeline.attachTo("#timeline",e),TweetActionsData.attachTo(document,e)}var timelineBoot=require("app/boot/timeline"),ListTimeline=require("app/ui/timelines/list_timeline"),TweetActionsData=require("app/data/tweet_actions"),utils=require("core/utils");module.exports=initialize
});
define("app/ui/profile/list_create_button",["module","require","exports","core/component"],function(module, require, exports) {
function listCreateButton(){this.defaultAttrs({createListSelector:".js-create-list-button"}),this.openListCreateDialog=function(){this.trigger("uiOpenCreateListDialog")},this.after("initialize",function(){this.on("click",{createListSelector:this.openListCreateDialog})})}var defineComponent=require("core/component");module.exports=defineComponent(listCreateButton)
});
define("app/pages/profile/lists",["module","require","exports","app/boot/profile","app/boot/list_timeline","app/data/tweet_actions","app/ui/profile/list_create_button"],function(module, require, exports) {
var profileBoot=require("app/boot/profile"),listTimelineBoot=require("app/boot/list_timeline"),TweetActionsData=require("app/data/tweet_actions"),ListCreateButton=require("app/ui/profile/list_create_button");module.exports=function(b){profileBoot(b),ListCreateButton.attachTo(".js-header-button-container"),listTimelineBoot(b,b.timeline_url,"list"),TweetActionsData.attachTo(document,b)}
});
define("app/ui/timelines/grid_timeline",["module","require","exports","core/component","app/ui/timelines/base_timeline","app/ui/timelines/with_old_items","app/ui/timelines/with_tweet_pagination","app/ui/timelines/with_activity_supplements","app/ui/with_timestamp_updating","app/ui/with_conversation_actions","app/ui/with_item_actions","app/ui/gallery/with_grid"],function(module, require, exports) {
function gridTimeline(){this.defaultAttrs({itemType:"tweet"}),this.reportInitialTweetsDisplayed=function(){var b=this.select("genericItemSelector"),c=[],d=function(b,d){var e=this.interactionData(this.findFirstItemContent($(d)));this.attr.reinjectedPromotedTweets&&(e.impressionId=undefined),c.push(e)}.bind(this);for(var e=0,f=b.length;e<f;e++)d(e,b[e]);var g={scribeContext:{component:"stream"},tweets:c};this.trigger("uiTweetsDisplayed",g)},this.reportTweetsDisplayed=function(a,b){b.tweets=b.items,this.trigger("uiTweetsDisplayed",b)},this.removeTweetsFromUser=function(a,b){var c=this.$node.find("[data-user-id="+b.userId+"]");c.parent().remove(),this.trigger("uiRemovedSomeTweets")},this.after("initialize",function(a){this.attr.reinjectedPromotedTweets=a.reinjectedPromotedTweets,this.reportInitialTweetsDisplayed(),this.on("uiHasInjectedNewTimeline uiHasInjectedOldTimelineItems uiHasInjectedRangeTimelineItems",this.reportTweetsDisplayed),this.on("uiRemoveTweetsFromUser",this.removeTweetsFromUser)})}var defineComponent=require("core/component"),BaseTimeline=require("app/ui/timelines/base_timeline"),withOldItems=require("app/ui/timelines/with_old_items"),withTweetPagination=require("app/ui/timelines/with_tweet_pagination"),withActivitySupplements=require("app/ui/timelines/with_activity_supplements"),withTimestampUpdating=require("app/ui/with_timestamp_updating"),withConversationActions=require("app/ui/with_conversation_actions"),withItemActions=require("app/ui/with_item_actions"),withGrid=require("app/ui/gallery/with_grid");module.exports=BaseTimeline.mixin(gridTimeline,withTweetPagination,withOldItems,withTimestampUpdating,withConversationActions,withItemActions,withActivitySupplements,withGrid)
});
define("app/boot/grid_timeline",["module","require","exports","app/boot/timeline","app/boot/tweets","app/boot/help_pips","app/ui/expando/close_all_button","app/ui/timelines/grid_timeline","app/ui/timeline_tweet_actions","app/ui/more_tweet_actions_dropdown","core/utils"],function(module, require, exports) {
function initialize(a,b,c,d){var e=utils.merge(a,{endpoint:b,itemType:c,eventData:{scribeContext:{component:d||c}}});timelineBoot(e),tweetsBoot("#timeline",e),e.help_pips_decider&&helpPipsBoot(e),CloseAllButton.attachTo("#close-all-button"),GridTimeline.attachTo("#timeline",e,{itemsSelector:"#stream-items-id .media-grid",gridHeight:230,gridRatio:1.6,gridWidth:582,tweetWithReplyDialogSelector:".grid-tweet"}),TimelineTweetActions.attachTo("#timeline",e,{tweetItemSelector:".grid-tweet"}),MoreTweetActionsDropdown.attachTo("#timeline",e,{tweetItemSelector:".grid-tweet"})}var timelineBoot=require("app/boot/timeline"),tweetsBoot=require("app/boot/tweets"),helpPipsBoot=require("app/boot/help_pips"),CloseAllButton=require("app/ui/expando/close_all_button"),GridTimeline=require("app/ui/timelines/grid_timeline"),TimelineTweetActions=require("app/ui/timeline_tweet_actions"),MoreTweetActionsDropdown=require("app/ui/more_tweet_actions_dropdown"),utils=require("core/utils");module.exports=initialize
});
define("app/pages/profile/media",["module","require","exports","app/boot/profile","app/boot/grid_timeline","app/boot/user_completion_module","app/data/contact_import","app/data/contact_import_scribe","app/ui/who_to_follow/import_loading_dialog","app/ui/who_to_follow/import_services"],function(module, require, exports) {
var profileBoot=require("app/boot/profile"),gridTimelineBoot=require("app/boot/grid_timeline"),userCompletionModuleBoot=require("app/boot/user_completion_module"),ContactImportData=require("app/data/contact_import"),ContactImportScribe=require("app/data/contact_import_scribe"),ImportLoadingDialog=require("app/ui/who_to_follow/import_loading_dialog"),ImportServices=require("app/ui/who_to_follow/import_services");module.exports=function(b){profileBoot(b),gridTimelineBoot(b,b.timeline_url,"tweet"),userCompletionModuleBoot(b),b.profile_user&&$(document).trigger("profileVisit",b.profile_user),ContactImportData.attachTo(document,b),ContactImportScribe.attachTo(document,b),ImportLoadingDialog.attachTo("#import-loading-dialog",b),ImportServices.attachTo(".dashboard .import-prompt",b,{otherServicesSelector:".other-services",eventData:{scribeContext:{component:"user_recommendations",element:"wtf_import_prompt"}}})}
});
define("app/ui/timelines/custom_timelines_timeline",["module","require","exports","core/component","app/ui/timelines/base_timeline","app/ui/timelines/with_old_items","app/ui/timelines/with_cursor_pagination","app/ui/with_item_actions","app/ui/with_user_actions"],function(module, require, exports) {
function customTimelinesTimeline(){this.defaultAttrs({itemType:"custom-timeline"})}var defineComponent=require("core/component"),BaseTimeline=require("app/ui/timelines/base_timeline"),withOldItems=require("app/ui/timelines/with_old_items"),withCursorPagination=require("app/ui/timelines/with_cursor_pagination"),withItemActions=require("app/ui/with_item_actions"),withUserActions=require("app/ui/with_user_actions");module.exports=BaseTimeline.mixin(customTimelinesTimeline,withOldItems,withCursorPagination,withItemActions,withUserActions)
});
define("app/boot/custom_timelines_timeline",["module","require","exports","app/boot/timeline","app/ui/timelines/custom_timelines_timeline","core/utils"],function(module, require, exports) {
function initialize(a,b,c,d){var e=utils.merge(a,{endpoint:b,itemType:c,eventData:{scribeContext:{component:d||c}}});timelineBoot(e),CustomTimelinesTimeline.attachTo("#timeline",e)}var timelineBoot=require("app/boot/timeline"),CustomTimelinesTimeline=require("app/ui/timelines/custom_timelines_timeline"),utils=require("core/utils");module.exports=initialize
});
define("app/pages/profile/custom_timelines",["module","require","exports","core/component","app/boot/profile","app/boot/custom_timelines_timeline","app/ui/with_custom_timeline_create_button","app/data/curation"],function(module, require, exports) {
var defineComponent=require("core/component"),profileBoot=require("app/boot/profile"),customTimelinesTimelineBoot=require("app/boot/custom_timelines_timeline"),withCustomTimelineCreateButton=require("app/ui/with_custom_timeline_create_button"),CurationData=require("app/data/curation");module.exports=function(b){profileBoot(b),defineComponent(withCustomTimelineCreateButton).attachTo(".js-header-button-container"),customTimelinesTimelineBoot(b,b.timeline_url,"custom-timeline"),CurationData.attachTo(document,b)}
});
define("app/ui/dialogs/edit_custom_timeline_dialog",["module","require","exports","core/component","app/ui/updating_text_counter","app/ui/with_dialog","app/ui/dialogs/with_create_or_edit_custom_timeline_dialog","template"],function(module, require, exports) {
function editCustomTimelineDialog(){this.defaultAttrs({createOrUpdateEventName:"uiUpdateCustomTimeline",orderSelector:"[name=edit-timeline-order]:checked"}),this.around("params",function(a){var b=a();return b.id=this.attr.timeline_id,b}),this.openDialog=function(){var a={is_create_dialog:!1,id_prefix:"edit",timeline_name:this.attr.timeline_name,timeline_description:this.attr.timeline_description,tweet_chron:this.attr.timeline_order=="tweet_chron",tweet_reverse_chron:this.attr.timeline_order=="tweet_reverse_chron",curation_reverse_chron:this.attr.timeline_order=="curation_reverse_chron"},b=template["dialogs/create_or_edit_custom_timeline_dialog"].render(a,template);this.$node.html(b),this.$dialog=this.$dialogContainer.find(this.attr.modalSelector),this.open()},this.after("open",function(){UpdatingTextCounter.attachTo(".custom-timeline-name-field",{maxLength:25,superwarnLength:20,warnLength:15,inputSelector:"#custom-timeline-name",counterSelector:".custom-timeline-name-count"}),UpdatingTextCounter.attachTo(".custom-timeline-description-field",{maxLength:160,superwarnLength:150,warnLength:140,inputSelector:"#custom-timeline-description",counterSelector:".custom-timeline-description-count"})}),this.after("initialize",function(){this.on(document,"uiOpenEditCustomTimelineDialog",this.openDialog)})}var defineComponent=require("core/component"),UpdatingTextCounter=require("app/ui/updating_text_counter"),withDialog=require("app/ui/with_dialog"),withCreateOrEditCustomTimelineDialog=require("app/ui/dialogs/with_create_or_edit_custom_timeline_dialog"),template=require("template");module.exports=defineComponent(withDialog,withCreateOrEditCustomTimelineDialog,editCustomTimelineDialog)
});
define("app/ui/timelines/custom_timeline",["module","require","exports","core/component","app/ui/timelines/base_timeline","app/ui/timelines/with_old_items","app/ui/timelines/with_new_items","app/ui/timelines/with_min_max_pagination","app/ui/with_timestamp_updating","app/ui/timelines/with_traveling_ptw","app/ui/with_item_actions","app/ui/with_user_actions","app/ui/gallery/with_gallery","app/ui/with_viewer_follow_state","app/utils/find_tweet"],function(module, require, exports) {
function customTimeline(){this.defaultAttrs({itemType:"tweet"}),this.removeTweetFromTimeline=function(a,b){var c=findTweet(this.$node,".tweet",b.sourceEventData.id);this.trigger(c,"uiBeforeTweetRemoved",b),c.closest(this.attr.tweetContainerSelector).remove(),this.trigger("uiTweetRemoved",b)},this.after("initialize",function(){this.on(document,"dataTweetRemovedFromTimeline",this.removeTweetFromTimeline)})}var defineComponent=require("core/component"),BaseTimeline=require("app/ui/timelines/base_timeline"),withOldItems=require("app/ui/timelines/with_old_items"),withNewItems=require("app/ui/timelines/with_new_items"),withMinMaxPagination=require("app/ui/timelines/with_min_max_pagination"),withTimestampUpdating=require("app/ui/with_timestamp_updating"),withTravelingPtw=require("app/ui/timelines/with_traveling_ptw"),withItemActions=require("app/ui/with_item_actions"),withUserActions=require("app/ui/with_user_actions"),withGallery=require("app/ui/gallery/with_gallery"),withViewerFollowState=require("app/ui/with_viewer_follow_state"),findTweet=require("app/utils/find_tweet");module.exports=BaseTimeline.mixin(customTimeline,withOldItems,withMinMaxPagination,withNewItems,withTimestampUpdating,withTravelingPtw,withItemActions,withUserActions,withGallery,withViewerFollowState)
});
define("app/ui/custom_timeline_tweetbox",["module","require","exports","core/component","app/ui/with_tweetbox_initialization"],function(module, require, exports) {
function customTimelineTweetbox(){this.defaultAttrs({defaultTextFrom:"data-default-text",condensedTextFrom:"data-condensed-text"}),this.getText=function(){return this.$node.attr(this.attr.defaultTextFrom)||""},this.getDefaultText=function(){return this.$node.attr(this.attr.defaultTextFrom)},this.getCondensedText=function(){return this.$node.attr(this.attr.condensedTextFrom)},this.after("initialize",function(){var a=this.$node.attr("data-selection-length");this.initTweetbox({canTweetDefaultText:this.attr.canTweetDefaultText,condensedText:this.getCondensedText(),defaultText:this.getDefaultText(),selectedRange:[0,a]})})}var defineComponent=require("core/component"),withTweetboxInitialization=require("app/ui/with_tweetbox_initialization");module.exports=defineComponent(withTweetboxInitialization,customTimelineTweetbox)
});
define("app/ui/custom_timeline_follow_card",["module","require","exports","core/component","core/i18n"],function(module, require, exports) {
function customTimelineFollowCard(){this.defaultAttrs({editSelector:".js-edit-custom-timeline-action",deleteSelector:".js-delete-custom-timeline-action",confirmAction:"DeleteCustomTimeline",confirmTitleText:_('\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u524a\u9664'),confirmBodyText:_('\u672c\u5f53\u306b\u3053\u306e\u30b3\u30ec\u30af\u30b7\u30e7\u30f3\u3092\u524a\u9664\u3057\u3066\u3088\u308d\u3057\u3044\u3067\u3059\u304b?'),confirmCancelText:_('\u3044\u3044\u3048'),confirmSubmitText:_('\u306f\u3044')}),this.triggerDeleteCustomTimelineDialog=function(){this.trigger("uiOpenConfirmDialog",{action:this.attr.confirmAction,titleText:this.attr.confirmTitleText,bodyText:this.attr.confirmBodyText,cancelText:this.attr.confirmCancelText,submitText:this.attr.confirmSubmitText})},this.triggerDelete=function(a,b){this.trigger("uiDeleteCustomTimeline",{timeline_id:this.attr.timeline_id})},this.after("initialize",function(){this.on("click",{editSelector:"uiOpenEditCustomTimelineDialog",deleteSelector:this.triggerDeleteCustomTimelineDialog}),this.on(document,"uiDeleteCustomTimelineConfirm",this.triggerDelete)})}var defineComponent=require("core/component"),_=require("core/i18n");module.exports=defineComponent(customTimelineFollowCard)
});
define("app/ui/with_curated_tweet_removal",["module","require","exports"],function(module, require, exports) {
function withCuratedTweetRemoval(){this.defaultAttrs({removeCuratedTweetSelector:".js-action-remove-curated-tweet"}),this.getTimelineId=function(){return{timelineId:this.attr.timeline_id}},this.after("initialize",function(){var a=this.mkTweetDataCollectorForAction(this.interactionData,this.getTimelineId);this.on("click",{removeCuratedTweetSelector:this.composeHandler(this.preventDefault,this.getClosestTweet,a,this.triggerTweetAction("uiCurateRemoveTweet"))})})}module.exports=withCuratedTweetRemoval
});
define("app/ui/custom_timeline_tweet_actions",["module","require","exports","app/ui/timeline_tweet_actions","app/ui/with_curated_tweet_removal"],function(module, require, exports) {
var TimelineTweetActions=require("app/ui/timeline_tweet_actions"),withCuratedTweetRemoval=require("app/ui/with_curated_tweet_removal");module.exports=TimelineTweetActions.mixin(withCuratedTweetRemoval)
});
define("app/boot/custom_timeline",["module","require","exports","app/boot/timeline","app/boot/tweets","app/ui/dialogs/edit_custom_timeline_dialog","app/ui/timelines/custom_timeline","app/ui/custom_timeline_tweetbox","app/ui/custom_timeline_follow_card","app/ui/expando/close_all_button","core/utils","app/ui/custom_timeline_tweet_actions","app/ui/with_retweet_prevention","app/ui/with_tweet_action_counts","app/ui/more_tweet_actions_dropdown"],function(module, require, exports) {
function initialize(a){var b=utils.merge(a,{endpoint:a.timeline_url,itemType:"tweet",eventData:{scribeContext:{component:"tweet"}}});timelineBoot(b),tweetsBoot("#timeline",b),CloseAllButton.attachTo("#close-all-button",{addEvent:"uiHasExpandedTweet uiHasDetachedConversation",subtractEvent:"uiHasCollapsedTweet uiHasReattachedConversation"}),CustomTimeline.attachTo("#timeline",b,{autoplay:!0});var c=a.experiments&&a.experiments.inTweetWebCountsExperiment?[withRetweetPrevention,withTweetActionCounts]:[];CustomTimelineTweetActions.mixin.apply(this,c).attachTo("#timeline",b),MoreTweetActionsDropdown.attachTo("#timeline",b),CustomTimelineTweetbox.attachTo(".custom-timeline-tweet-box",{draftTweetId:"custom_timeline_"+b.timeline_id,canTweetDefaultText:!0,eventData:{scribeContext:{component:"tweet_box"}}}),CustomTimelineFollowCard.attachTo(".custom-timeline-follow-card",{timeline_id:a.timeline_id}),EditCustomTimelineDialog.attachTo("#edit-custom-timeline-dialog",a)}var timelineBoot=require("app/boot/timeline"),tweetsBoot=require("app/boot/tweets"),EditCustomTimelineDialog=require("app/ui/dialogs/edit_custom_timeline_dialog"),CustomTimeline=require("app/ui/timelines/custom_timeline"),CustomTimelineTweetbox=require("app/ui/custom_timeline_tweetbox"),CustomTimelineFollowCard=require("app/ui/custom_timeline_follow_card"),CloseAllButton=require("app/ui/expando/close_all_button"),utils=require("core/utils"),CustomTimelineTweetActions=require("app/ui/custom_timeline_tweet_actions"),withRetweetPrevention=require("app/ui/with_retweet_prevention"),withTweetActionCounts=require("app/ui/with_tweet_action_counts"),MoreTweetActionsDropdown=require("app/ui/more_tweet_actions_dropdown");module.exports=initialize
});
define("app/pages/custom_timeline",["module","require","exports","app/boot/app","app/boot/logged_out","app/boot/custom_timeline"],function(module, require, exports) {
var bootApp=require("app/boot/app"),loggedOutBoot=require("app/boot/logged_out"),customBoot=require("app/boot/custom_timeline");module.exports=function(b){bootApp(b),loggedOutBoot(b),customBoot(b)}
});